Attaching 5883 to 976296.io01
Attaching 21428 to 976296.io01
Attaching 15862 to 976296.io01
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
arg=0: ./angel.bin
arg=1: pn
arg=2: ../results/try.log
Environment variable NEGFDIR not found. Assuming
   /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master
as base directory.
Output:    /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/
Logfile:   /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/logs/negf_20160114_071226.out
Materials: /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/materials/
work started !!!
work started !!!
logfile: ../results/try.log
work started !!!
work started !!!
work started !!!
work started !!!work started !!!

work started !!!
work started !!!
work started !!!work started !!!

work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!
work started !!!work started !!!

work started !!!
work started !!!
work started !!!
work started !!!
Creating /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/
Creating /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/ for output
node470 (p26), node470 (p28), node470 (p25), node324 (p9), node470 (p30), node410 (p22), node470 (p24), node324 (p10), node470 (p27), node470 (p31), node124 (p4), node470 (p29), node324 (p11), node124 (p5), node410 (p21), node324 (p13), node410 (p23), node324 (p12), node324 (p14), node124 (p3), node410 (p20), node324 (p8), node124 (p6), node324 (p15), node124 (p2), node410 (p18), node124 (p0), node410 (p16), node124 (p7), node410 (p17), node124 (p1), node410 (p19), 
|====================================================================|
|**********                                                **********|
|*        *** Welcome to ANGEL (A NEGF solver for LEDs) ***         *|
|**********                                                **********|
|====================================================================|
Materials directory : /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/materials/
Simulation directory: ./
|--------------------------------------------------------------------|
|                          reading options                           |
|--------------------------------------------------------------------|
File: ./pn.cmd
kpmethod Get !kpmethod Get !3
3
kpmethod Get !3
kpmethod Get !kpmethod Get !kpmethod Get !3
3
kpmethod Get !kpmethod Get !3
33

kpmethod Get !3
kpmethod Get !kpmethod Get !3
kpmethod Get !kpmethod Get !3
3
3
Option reading initialated !!!
kpmethod Get !kpmethod Get !3
3
kpmethod Get !3
kpmethod Get !3
kpmethod Get !3
kpmethod Get !kpmethod Get !3
3
kpmethod Get !3
kpmethod Get !3
kpmethod Get !3
Option reading initialated !!!
kpmethod Get !3
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
kpmethod Get !3
Option reading initialated !!!
kpmethod Get !3
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
kpmethod Get !kpmethod Get !3
3
Option reading initialated !!!
kpmethod Get !3
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
kpmethod Get !3
Option reading initialated !!!
Option reading initialated !!!
kpmethod Get !kpmethod Get !Option reading initialated !!!
3
3
Option reading initialated !!!
Option reading initialated !!!
Option reading initialated !!!
|--------------------------------------------------------------------|Option reading initialated !!!

|                        setting up energies                         |
|--------------------------------------------------------------------|
Emin=-5.00e-01, Emax=2.10e+00, nE=375 (equally spaced in the beginning)
|--------------------------------------------------------------------|
|                     setting up real-space grid                     |
|--------------------------------------------------------------------|
reading region 0...
Region 1 (material GaAs): length=15, dx=1...
reading region 1...
Region 2 (material GaAs): length=32, dx=1...
reading region 2...
Region 3 (material GaAs): length=15, dx=1...
    Geometry::prepare()...
There are 61 internal vertices.
vertex 0 in region contact_0 was now assigned to contact Source.
vertex 1 in region contact_0 was now assigned to contact Source.
vertex 65 in region contact_1 was now assigned to contact Drain.
vertex 66 in region contact_1 was now assigned to contact Drain.
Warning: overwrote the contact's adjacent region.
Warning: overwrote the contact's adjacent region.
Warning: overwrote the contact's adjacent region.
preparation of geometry object done.
    Geometry::verify()...
Total volume calculated from elements: 6.6000000000e+01
geometry looks good!
|--------------------------------------------------------------------|
|                       reading material data                        |
|--------------------------------------------------------------------|
Materials directory is /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/materials/
Region contact_0 (material=GaAs)...
Region region0 (material=GaAs)...
Region region1 (material=GaAs)...
Region region2 (material=GaAs)...
Region contact_1 (material=GaAs)...
|--------------------------------------------------------------------|
|                         setting up k-space                         |
|--------------------------------------------------------------------|
Material "GaAs" is bulk.
Testing with m=0.5m0.
Suggested kmax: 1.620077e+00[nm-1].
E=-2.000e-01[eV]: numerical and analytical results do not agree: F0=2.0887e-01, numerically 1.7128e-01, rel_err=0.18
E=-1.929e-01[eV]: numerical and analytical results do not agree: F0=2.0149e-01, numerically 1.6924e-01, rel_err=0.16
E=-1.859e-01[eV]: numerical and analytical results do not agree: F0=1.9412e-01, numerically 1.6678e-01, rel_err=0.14
E=-1.788e-01[eV]: numerical and analytical results do not agree: F0=1.8674e-01, numerically 1.6385e-01, rel_err=0.12
E=-1.717e-01[eV]: numerical and analytical results do not agree: F0=1.7936e-01, numerically 1.6043e-01, rel_err=0.11
E=-1.646e-01[eV]: numerical and analytical results do not agree: F0=1.7199e-01, numerically 1.5652e-01, rel_err=0.09
E=-1.576e-01[eV]: numerical and analytical results do not agree: F0=1.6462e-01, numerically 1.5212e-01, rel_err=0.076
E=-1.505e-01[eV]: numerical and analytical results do not agree: F0=1.5725e-01, numerically 1.4725e-01, rel_err=0.064
E=-1.434e-01[eV]: numerical and analytical results do not agree: F0=1.4990e-01, numerically 1.4196e-01, rel_err=0.053
E=-1.364e-01[eV]: numerical and analytical results do not agree: F0=1.4254e-01, numerically 1.3630e-01, rel_err=0.044
E=-1.293e-01[eV]: numerical and analytical results do not agree: F0=1.3520e-01, numerically 1.3032e-01, rel_err=0.036
E=-1.222e-01[eV]: numerical and analytical results do not agree: F0=1.2788e-01, numerically 1.2408e-01, rel_err=0.03
E=-1.152e-01[eV]: numerical and analytical results do not agree: F0=1.2057e-01, numerically 1.1763e-01, rel_err=0.024
E=-1.081e-01[eV]: numerical and analytical results do not agree: F0=1.1328e-01, numerically 1.1101e-01, rel_err=0.02
E=-1.010e-01[eV]: numerical and analytical results do not agree: F0=1.0602e-01, numerically 1.0428e-01, rel_err=0.016
E=-9.394e-02[eV]: numerical and analytical results do not agree: F0=9.8806e-02, numerically 9.7462e-02, rel_err=0.014
E=-8.687e-02[eV]: numerical and analytical results do not agree: F0=9.1640e-02, numerically 9.0607e-02, rel_err=0.011
|--------------------------------------------------------------------|
|      voltage settings, which contacts are ramped by how much       |
|--------------------------------------------------------------------|
Reading ./pn...
Experiments with numbers 1, have been detected. Will perform them in sorted order.
|--------------------------------------------------------------------|
|                     setting up Poisson problem                     |
|--------------------------------------------------------------------|
DOPING:
      0      1      2      3      4      5      6      7      8      9     10     11     12     13     14     15     16     17     18     19     20     21     22     23     24     25     26     27     28     29     30     31     32     33     34     35     36     37     38     39     40     41     42     43     44     45     46     47     48     49     50     51     52     53     54     55     56     57     58     59     60     61     62     63     64     65     66Assigning Neumann condition for potential at every contact.
Initializing potential values to zero.
---------------------------------------------------
Setting up Poisson equation and density equations
---------------------------------------------------
There are 199 nonzeros in the stiffness and mass matrices
Contact 0 is near x=2, Contact 1 near x=64.
Initial guess for potential (new method using EF0=0.000, EF1=0.800V)...
inital guess of el.stat.potential:
0   0   0   0.0142924   0.0285847   0.0428771   0.0571695   0.0714619   0.0857542   0.100047   0.114339   0.128631   0.142924   0.157216   0.171508   0.185801   0.200093   0.214386   0.228678   0.24297   0.257263   0.271555   0.285847   0.30014   0.314432   0.328725   0.343017   0.357309   0.371602   0.385894   0.400186   0.414479   0.428771   0.443063   0.457356   0.471648   0.485941   0.500233   0.514525   0.528818   0.54311   0.557402   0.571695   0.585987   0.60028   0.614572   0.628864   0.643157   0.657449   0.671741   0.686034   0.700326   0.714619   0.728911   0.743203   0.757496   0.771788   0.78608   0.800373   0.814665   0.828957   0.84325   0.857542   0.871835   0.886127   0.900419   0.914712   
|--------------------------------------------------------------------|
|                    setting up Hamiltonian class                    |
|--------------------------------------------------------------------|
kpmethod=3. Spin degeneracy: electrons: 2, holes: 2.
Setting bulk configuration object.
Using 2-band effective mass model and orthogonal (Datta) basis.
Done creating interface.
|--------------------------------------------------------------------|
|                    setting up overlap matrices                     |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|                     setting up Green functions                     |
|--------------------------------------------------------------------|
Allocating memory for a NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*7 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
finished allocating memory for total self energy.
|--------------------------------------------------------------------|
|                   setting up contact self-energy                   |
|--------------------------------------------------------------------|
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
|--------------------------------------------------------------------|
|               setting up acoustic phonon self-energy               |
|--------------------------------------------------------------------|
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Allocating memory for a banded (2*3 offdiags) NEGF object with Nx=61, Nn=2, Nk=40
Material "GaAs" is taken for the bulk optical phonon properties.
Deformation potential band 1: 7
Deformation potential band 2: 3.5
Mass density: 5.4e+03[kg m-3]
Speed of sound: 5.2e+03[m/s]
Lattice constant: 5.65[A]
Total AC phonon scattering prefactor (band 0): 0.00022
|--------------------------------------------------------------------|
|               setting up post-processing quantities                |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|       setting up inner loop with Dyson and Keldysh equation        |
|--------------------------------------------------------------------|
---------------------------------------------------
Calculating contact 0 density of states from GR
---------------------------------------------------
Calculating retarded contact self-energy w/o potential
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
Calculating GR w/o potential
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.


before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

p18: GR(E=210,:)...   p12: GR(E=140,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p31: GR(E=370,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   Aggregating total DOS...
Communicating total DOS...
Maximum number of inner iterations is now 20.
|--------------------------------------------------------------------|
|                 setting up outer loop Poisson-NEGF                 |
|--------------------------------------------------------------------|
Electrostatic potential will be underrelaxed by 0.4
Maximum number of outer iterations is now 20.
New outer convergence criterion is 0.0001.

|=======================================================================================|
|********************                                               ********************|
|********************                 Drain:  0.800V                ********************|
|********************                                               ********************|
|=======================================================================================|
*** Updating voltages.. ***
|--------------------------------------------------------------------|
|                         updating voltages                          |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|                        updating fermilevels                        |
|--------------------------------------------------------------------|
---------------------------------------------------
Calculating contact 0 density of states from GR
---------------------------------------------------
Calculating retarded contact self-energy w/o potential
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

Calculating GR w/o potential
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.

before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

before synchronization...S.Z.
before synchronization...S.Z.

p6: GR(E=70,:)...   p12: GR(E=140,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p31: GR(E=370,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   Aggregating total DOS...
Communicating total DOS...
---------------------------------------------------
Calculating contact 0 fermilevel (doping=-1.000e-02)
---------------------------------------------------
   initial guess: mu=-1.323808e-02, n=9.155e-07, p=2.068e-02 (Ec=1.422482e+00, Ev=0.000000e+00, dop=-1.00e-02)
 Iteration 1: F = 9.154614e-07(n) - 2.068266e-02(p) - -1.000000e-02(dop) = -1.068175e-02
 Iteration 1: mu_new=5.495780e-03, n_new=9.652e-07, p_new=1.195e-02, dop=-1.00e-02
 Iteration 2: F = 9.651901e-07(n) - 1.195114e-02(p) - -1.000000e-02(dop) = -1.950179e-03
 Iteration 2: mu_new=1.078070e-02, n_new=9.795e-07, p_new=1.013e-02, dop=-1.00e-02
 Iteration 3: F = 9.794838e-07(n) - 1.013027e-02(p) - -1.000000e-02(dop) = -1.292908e-04
 Iteration 3: mu_new=1.118374e-02, n_new=9.806e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 4: F = 9.805787e-07(n) - 1.000169e-02(p) - -1.000000e-02(dop) = -7.065073e-07
 Iteration 4: mu_new=1.118597e-02, n_new=9.806e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 5: F = 9.805848e-07(n) - 1.000098e-02(p) - -1.000000e-02(dop) = -2.146084e-11
Fermilevel convergence reached after 5 iterations: mu=0.011186
new electrostatic potential underrelaxation parameter: 0.3
new electrostatic potential LATE underrelaxation: 0
|--------------------------------------------------------------------|
|                  Initial guess for self-energies                   |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Assigning contact self-energy to total self-energy...
|--------------------------------------------------------------------|
|      Initial guess for retarded and advanced Green functions       |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p6: GR(E=70,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p21: GR(E=250,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p20: GR(E=240,:)...   p26: GR(E=310,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 1...                       *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 0.01
|====================================================================|
|**********                                                **********|
|*               Outer iteration with zero scattering               *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 0
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.08e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.31e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p8: GL(E=100,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -5.853e-05[A/cm2], hcurrent -5.469e-09[A/cm2], total -5.854e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  5.853e-05[A/cm2], hcurrent  1.920e-17[A/cm2], total  5.853e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -5.853e-05[A/cm2], hcurrent -8.853e-09[A/cm2], total -5.854e-05[A/cm2]
Contact 1: ecurrent -5.853e-05[A/cm2], hcurrent -7.036e-19[A/cm2], total -5.853e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.479320e+02, |LDOS|=1.481377e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=2.44e-02, rel_change=9.76e-01;  |p(x)|=3.94e-03, rel_change=8.66e-01.
     |Je(x)|=2.83e-11, rel_change=7.56e-06; |Jh(x)|=7.17e-15, rel_change=1.91e-09.
No inner convergence because first inner loop.
Coherent particle conservation:            1.723e-09 [A/cm2,n=0]  -5.469e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     0.000e+00 [A/cm2,n=0]   0.000e+00 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 9.36e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p20: GL(E=240,:)...   p26: GL(E=310,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p24: GL(E=290,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -5.853e-05[A/cm2], hcurrent -5.469e-09[A/cm2], total -5.854e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  5.853e-05[A/cm2], hcurrent  1.920e-17[A/cm2], total  5.853e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -5.853e-05[A/cm2], hcurrent -8.853e-09[A/cm2], total -5.854e-05[A/cm2]
Contact 1: ecurrent -5.853e-05[A/cm2], hcurrent -7.036e-19[A/cm2], total -5.853e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.479320e+02, |LDOS|=1.481377e+02
Inner convergence achieved! eps=1.00e-03
      |n(x)|=2.44e-02, rel_change=0.00e+00;  |p(x)|=3.94e-03, rel_change=0.00e+00;
     |Je(x)|=2.83e-11, rel_change=0.00e+00; |Jh(x)|=7.17e-15, rel_change=0.00e+00;
Coherent particle conservation:            1.723e-09 [A/cm2,n=0]  -5.469e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     0.000e+00 [A/cm2,n=0]   0.000e+00 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
Inner loop converged in 2 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.908e-07
hdensity at contact 0: 3.168e-03
edensity at contact 1: 1.074e-02
hdensity at contact 1: 1.228e-07
nE_max at internal vertex 1: 1.45558e-05
*** PoissonFEM1D*** 
 elstat_pot = 0  0  0  0.0142924  0.0285847  0.0428771  0.0571695  0.0714619  0.0857542  0.100047  0.114339  0.128631  0.142924  0.157216  0.171508  0.185801  0.200093  0.214386  0.228678  0.24297  0.257263  0.271555  0.285847  0.30014  0.314432  0.328725  0.343017  0.357309  0.371602  0.385894  0.400186  0.414479  0.428771  0.443063  0.457356  0.471648  0.485941  0.500233  0.514525  0.528818  0.54311  0.557402  0.571695  0.585987  0.60028  0.614572  0.628864  0.643157  0.657449  0.671741  0.686034  0.700326  0.714619  0.728911  0.743203  0.757496  0.771788  0.78608  0.800373  0.814665  0.828957  0.84325  0.857542  0.871835  0.886127  0.900419  0.914712  
edens = 9.90827e-07  9.90827e-07  9.90827e-07  9.90827e-07  3.50118e-08  1.32576e-09  5.38319e-11  2.92615e-12  1.22313e-12  1.95481e-12  3.3926e-12  5.89838e-12  1.02538e-11  1.78242e-11  3.09827e-11  5.38543e-11  9.36092e-11  1.6271e-10  2.82819e-10  4.91588e-10  8.54461e-10  1.48518e-09  2.58145e-09  4.48682e-09  7.7983e-09  1.35531e-08  2.35527e-08  4.09243e-08  7.10922e-08  1.23454e-07  2.14261e-07  3.71541e-07  6.43439e-07  1.11221e-06  1.91731e-06  3.29282e-06  5.62647e-06  9.54978e-06  1.60699e-05  2.67521e-05  4.39539e-05  7.1095e-05  0.000112919  0.000175661  0.000267004  0.000395687  0.000570675  0.000799929  0.001089  0.00143987  0.00185058  0.00231588  0.00282891  0.00338318  0.00397419  0.00459988  0.0052599  0.00595384  0.00667938  0.00743242  0.00821079  0.00901866  0.00986181  0.0107371  0.0107371  0.0107371  0.0107371  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.272757, at last vertex: 0.857379.
Setting scaling of acoustic phonon scattering to 0.01
|====================================================================|
|**********                                                **********|
|*         Outer iteration with scattering reduced by 0.04          *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 0.04
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 10 receivers This time we have 5 receivers This time we have 1 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 10 receivers This time we have 5 receivers This time we have 1 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 10 receivers This time we have 5 receivers This time we have 1 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 10 receivers This time we have 5 receivers This time we have 1 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 10 receivers This time we have 5 receivers This time we have 1 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.20e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.69e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p15: GR(E=180,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 6 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p30: GL(E=360,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.178e-09[A/cm2], hcurrent -1.516e+01[A/cm2], total -1.516e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.047e-09[A/cm2], hcurrent -8.582e-17[A/cm2], total  1.047e-09[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.178e-09[A/cm2], hcurrent -1.517e+01[A/cm2], total -1.517e+01[A/cm2]
Contact 1: ecurrent -1.310e-09[A/cm2], hcurrent -3.341e-20[A/cm2], total -1.310e-09[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.767264e+02, |LDOS|=2.620906e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.21e-02, rel_change=3.37e-01;  |p(x)|=5.18e-01, rel_change=9.93e-01.
     |Je(x)|=5.78e-16, rel_change=7.56e-06; |Jh(x)|=9.90e-07, rel_change=2.09e-01.
No inner convergence because first inner loop.
Coherent particle conservation:           -1.987e-10 [A/cm2,n=0]  -3.977e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.766e-11 [A/cm2,n=0]   3.977e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.40e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p31: GL(E=370,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p30: GL(E=360,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.178e-09[A/cm2], hcurrent -3.321e-01[A/cm2], total -3.321e-01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.302e-09[A/cm2], hcurrent  1.150e-16[A/cm2], total  1.302e-09[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.178e-09[A/cm2], hcurrent -3.329e-01[A/cm2], total -3.329e-01[A/cm2]
Contact 1: ecurrent -1.384e-09[A/cm2], hcurrent  9.021e-19[A/cm2], total -1.384e-09[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=2.302975e+02, |LDOS|=3.024633e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.21e-02, rel_change=1.03e-04;  |p(x)|=5.19e-01, rel_change=4.21e-03.
     |Je(x)|=5.64e-16, rel_change=4.63e-11; |Jh(x)|=5.20e-08, rel_change=2.54e-01.
Coherent particle conservation:            1.862e-10 [A/cm2,n=0]  -3.590e-01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.458e-12 [A/cm2,n=0]   3.590e-01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.14e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.35e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.178e-09[A/cm2], hcurrent -2.981e-03[A/cm2], total -2.981e-03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.600e-10[A/cm2], hcurrent  2.364e-17[A/cm2], total  3.600e-10[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.178e-09[A/cm2], hcurrent -3.001e-03[A/cm2], total -3.001e-03[A/cm2]
Contact 1: ecurrent -1.611e-09[A/cm2], hcurrent  1.818e-18[A/cm2], total -1.611e-09[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=2.441051e+02, |LDOS|=3.123054e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.21e-02, rel_change=1.47e-09;  |p(x)|=5.19e-01, rel_change=1.01e-03.
     |Je(x)|=6.03e-16, rel_change=6.84e-11; |Jh(x)|=4.68e-10, rel_change=1.38e-02.
Coherent particle conservation:           -7.945e-10 [A/cm2,n=0]  -3.211e-03 [A/cm2,n=1]  
Acoustic phonon particle conservation:     5.361e-14 [A/cm2,n=0]   3.211e-03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
|====================================================================|
|                        Inner iteration 4...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.54e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.178e-09[A/cm2], hcurrent -2.858e-05[A/cm2], total -2.858e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  7.667e-10[A/cm2], hcurrent -1.241e-16[A/cm2], total  7.667e-10[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.178e-09[A/cm2], hcurrent -2.875e-05[A/cm2], total -2.876e-05[A/cm2]
Contact 1: ecurrent -1.666e-09[A/cm2], hcurrent  3.365e-19[A/cm2], total -1.666e-09[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=2.654324e+02, |LDOS|=3.291487e+02
Inner convergence achieved! eps=1.00e-03
      |n(x)|=3.21e-02, rel_change=3.55e-14;  |p(x)|=5.19e-01, rel_change=3.86e-04;
     |Je(x)|=6.15e-16, rel_change=7.07e-11; |Jh(x)|=4.54e-12, rel_change=1.24e-04;
Coherent particle conservation:           -5.185e-10 [A/cm2,n=0]  -3.066e-05 [A/cm2,n=1]  
Acoustic phonon particle conservation:     9.740e-14 [A/cm2,n=0]   3.066e-05 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_LDOS ... Done.
Inner loop converged in 4 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 6.797e-07
hdensity at contact 0: 1.998e-01
edensity at contact 1: 9.867e-03
hdensity at contact 1: 1.275e-07
nE_max at internal vertex 1: 9.78348e-06
*** PoissonFEM1D*** 
 elstat_pot = -0.272757  -0.272757  -0.272757  -0.272757  -0.271415  -0.257123  -0.242831  -0.228538  -0.214246  -0.199953  -0.185661  -0.171369  -0.157076  -0.142784  -0.128492  -0.114199  -0.0999068  -0.0856144  -0.0713221  -0.0570297  -0.0427373  -0.028445  -0.0141526  0.000139779  0.0144321  0.0287245  0.0430169  0.0573093  0.0716016  0.085894  0.100186  0.114479  0.128771  0.143063  0.157356  0.171648  0.185941  0.203408  0.247668  0.291716  0.335461  0.378786  0.42156  0.463656  0.504993  0.545596  0.585669  0.625674  0.666397  0.707834  0.745668  0.775766  0.798618  0.815704  0.828287  0.837413  0.843929  0.848511  0.851688  0.853865  0.855343  0.856332  0.856979  0.857379  0.857379  0.857379  0.857379  
edens = 6.79701e-07  6.79701e-07  6.79701e-07  6.79701e-07  1.94513e-08  5.8988e-10  1.88817e-11  6.37581e-13  2.53763e-14  4.31288e-15  4.13803e-15  4.13803e-15  4.13803e-15  4.13803e-15  4.15965e-15  4.30493e-15  4.612e-15  5.19369e-15  6.23911e-15  8.099e-15  1.13702e-14  1.70925e-14  2.70547e-14  4.43997e-14  7.45947e-14  1.27258e-13  2.19448e-13  3.82383e-13  6.76466e-13  1.23085e-12  2.36376e-12  4.99071e-12  1.21215e-11  3.46582e-11  1.14773e-10  4.23006e-10  1.67029e-09  6.88164e-09  2.89416e-08  1.17302e-07  4.49976e-07  1.6199e-06  5.43975e-06  1.69504e-05  4.87717e-05  0.000128972  0.00031196  0.000686539  0.0013653  0.00242921  0.00381866  0.00528773  0.00655419  0.00748977  0.00815185  0.00865471  0.00905149  0.00933993  0.00952807  0.00965258  0.00974349  0.00980204  0.00982606  0.00986701  0.00986701  0.00986701  0.00986701  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.112254, at last vertex: 0.855635.
|====================================================================|
|**********                                                **********|
|*         Outer iteration with scattering reduced by 0.16          *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 0.16
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.46e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p15: GR(E=180,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p9: GL(E=110,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p30: GL(E=360,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -5.686e-07[A/cm2], hcurrent -8.903e-07[A/cm2], total -1.459e-06[A/cm2]
Right contact (SLGG-SGGL): ecurrent  5.663e-07[A/cm2], hcurrent -2.734e-16[A/cm2], total  5.663e-07[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -5.686e-07[A/cm2], hcurrent -8.855e-07[A/cm2], total -1.454e-06[A/cm2]
Contact 1: ecurrent -5.663e-07[A/cm2], hcurrent -8.518e-19[A/cm2], total -5.663e-07[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.933820e+02, |LDOS|=2.244294e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.22e-02, rel_change=5.42e-02;  |p(x)|=1.44e-01, rel_change=2.59e+00.
     |Je(x)|=2.74e-13, rel_change=7.31e-08; |Jh(x)|=1.26e-13, rel_change=1.18e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -2.282e-09 [A/cm2,n=0]  -9.742e-07 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.853e-09 [A/cm2,n=0]   9.968e-07 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.17e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.36e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -5.685e-07[A/cm2], hcurrent -9.309e-12[A/cm2], total -5.685e-07[A/cm2]
Right contact (SLGG-SGGL): ecurrent  5.686e-07[A/cm2], hcurrent -2.438e-17[A/cm2], total  5.686e-07[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -5.685e-07[A/cm2], hcurrent  4.361e-08[A/cm2], total -5.249e-07[A/cm2]
Contact 1: ecurrent -5.672e-07[A/cm2], hcurrent -5.976e-19[A/cm2], total -5.672e-07[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=2.371564e+02, |LDOS|=2.631307e+02
Inner convergence achieved! eps=1.00e-03
      |n(x)|=3.22e-02, rel_change=7.64e-06;  |p(x)|=1.44e-01, rel_change=3.19e-04;
     |Je(x)|=2.75e-13, rel_change=1.71e-10; |Jh(x)|=4.59e-14, rel_change=3.35e-08;
Coherent particle conservation:           -6.664e-12 [A/cm2,n=0]  -2.374e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.504e-11 [A/cm2,n=0]   2.993e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
Inner loop converged in 2 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 8.392e-07
hdensity at contact 0: 5.791e-02
edensity at contact 1: 9.767e-03
hdensity at contact 1: 1.279e-07
nE_max at internal vertex 1: 1.22144e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.112254  -0.112254  -0.112254  -0.112254  -0.110029  -0.105011  -0.0985638  -0.0919125  -0.0854676  -0.0793326  -0.0735477  -0.068135  -0.0630364  -0.058085  -0.0530637  -0.0475137  -0.0403315  -0.0302329  -0.0190535  -0.00884733  0.00141021  0.0127753  0.0258177  0.0408857  0.058136  0.0775419  0.0988539  0.121623  0.145433  0.170057  0.195393  0.221378  0.247933  0.274909  0.302147  0.329545  0.35704  0.384585  0.412151  0.439721  0.467294  0.494871  0.522463  0.5501  0.577853  0.605886  0.634521  0.6643  0.69603  0.729653  0.760774  0.785276  0.803742  0.817666  0.828161  0.836025  0.841874  0.846208  0.84941  0.851752  0.853427  0.854577  0.855296  0.855635  0.855635  0.855635  0.855635  
edens = 8.39221e-07  8.39221e-07  8.39221e-07  8.39221e-07  2.68171e-08  9.07322e-10  3.23621e-11  1.21285e-12  5.07153e-14  5.97363e-15  5.20385e-15  5.5372e-15  5.99884e-15  6.60741e-15  7.49779e-15  8.83979e-15  1.09846e-14  1.4569e-14  2.07551e-14  3.18367e-14  5.29541e-14  9.60856e-14  1.90307e-13  4.08934e-13  9.43009e-13  2.30368e-12  5.8871e-12  1.55685e-11  4.22427e-11  1.16846e-10  3.27772e-10  9.2814e-10  2.6411e-09  7.51827e-09  2.13128e-08  5.98943e-08  1.66088e-07  4.52281e-07  1.2035e-06  3.11364e-06  7.79329e-06  1.87805e-05  4.33759e-05  9.56115e-05  0.000200365  0.000397784  0.000745522  0.00131363  0.00216335  0.00329799  0.0045948  0.0058295  0.00683331  0.00758257  0.00814837  0.00859674  0.00894824  0.00920697  0.0093921  0.00953098  0.00963577  0.00970038  0.00972577  0.00976662  0.00976662  0.00976662  0.00976662  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.0476111, at last vertex: 0.855772.
|====================================================================|
|**********                                                **********|
|*         Outer iteration with scattering reduced by 0.64          *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 0.64
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.13e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p4: GR(E=50,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 23 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.638e-06[A/cm2], hcurrent  8.265e-09[A/cm2], total -6.630e-06[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.515e-06[A/cm2], hcurrent  3.262e-17[A/cm2], total  6.515e-06[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.638e-06[A/cm2], hcurrent  2.415e-08[A/cm2], total -6.614e-06[A/cm2]
Contact 1: ecurrent -6.515e-06[A/cm2], hcurrent  1.963e-18[A/cm2], total -6.515e-06[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.802954e+02, |LDOS|=1.929153e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.25e-02, rel_change=1.81e-02;  |p(x)|=5.48e-02, rel_change=1.63e+00.
     |Je(x)|=3.19e-12, rel_change=7.78e-07; |Jh(x)|=1.02e-12, rel_change=2.72e-07.
No inner convergence because first inner loop.
Coherent particle conservation:           -1.263e-07 [A/cm2,n=0]   8.307e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.261e-07 [A/cm2,n=0]  -9.132e-09 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.46e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 1.06e+00[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p4: GR(E=50,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p20: GL(E=240,:)...   p26: GL(E=310,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p31: GL(E=370,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p30: GL(E=360,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.630e-06[A/cm2], hcurrent  1.857e-09[A/cm2], total -6.628e-06[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.626e-06[A/cm2], hcurrent -2.120e-16[A/cm2], total  6.626e-06[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.630e-06[A/cm2], hcurrent -4.362e-08[A/cm2], total -6.673e-06[A/cm2]
Contact 1: ecurrent -6.627e-06[A/cm2], hcurrent -4.781e-18[A/cm2], total -6.627e-06[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.885913e+02, |LDOS|=2.007225e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.25e-02, rel_change=9.42e-06;  |p(x)|=5.47e-02, rel_change=2.59e-03.
     |Je(x)|=3.20e-12, rel_change=6.78e-09; |Jh(x)|=2.24e-14, rel_change=2.73e-07.
Coherent particle conservation:           -3.267e-09 [A/cm2,n=0]   2.069e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.764e-09 [A/cm2,n=0]   2.698e-09 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.16e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.38e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p20: GL(E=240,:)...   p26: GL(E=310,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.629e-06[A/cm2], hcurrent -8.168e-09[A/cm2], total -6.638e-06[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.629e-06[A/cm2], hcurrent -2.141e-16[A/cm2], total  6.629e-06[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.629e-06[A/cm2], hcurrent  2.430e-08[A/cm2], total -6.605e-06[A/cm2]
Contact 1: ecurrent -6.628e-06[A/cm2], hcurrent  3.151e-18[A/cm2], total -6.628e-06[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.808450e+02, |LDOS|=1.934627e+02
Inner convergence achieved! eps=1.00e-03
      |n(x)|=3.25e-02, rel_change=3.39e-09;  |p(x)|=5.47e-02, rel_change=2.53e-06;
     |Je(x)|=3.21e-12, rel_change=1.47e-10; |Jh(x)|=2.56e-14, rel_change=8.16e-09;
Coherent particle conservation:           -1.623e-10 [A/cm2,n=0]  -8.104e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.306e-11 [A/cm2,n=0]  -2.504e-09 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.172e-07
hdensity at contact 0: 1.864e-02
edensity at contact 1: 9.785e-03
hdensity at contact 1: 1.279e-07
nE_max at internal vertex 1: 1.34159e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0476111  -0.0476111  -0.0476111  -0.0476111  -0.0467659  -0.0452935  -0.0434154  -0.0413642  -0.0392959  -0.037283  -0.035349  -0.0334754  -0.0315771  -0.029452  -0.0266803  -0.0224053  -0.0149718  -0.00281214  0.0116567  0.025644  0.0400606  0.0560887  0.0742102  0.0943623  0.116132  0.138988  0.162473  0.186276  0.210223  0.23423  0.258258  0.282292  0.30633  0.330368  0.354406  0.378445  0.402484  0.426523  0.450565  0.474611  0.498669  0.522753  0.546898  0.571168  0.59569  0.620683  0.646511  0.673738  0.703207  0.734933  0.764597  0.788069  0.805827  0.819233  0.829322  0.836874  0.842503  0.846684  0.849774  0.85203  0.853642  0.854752  0.855447  0.855772  0.855772  0.855772  0.855772  
edens = 9.17215e-07  9.17215e-07  9.17215e-07  9.17215e-07  3.06737e-08  1.08577e-09  4.0454e-11  1.58213e-12  7.0726e-14  1.02887e-14  9.13159e-15  9.86352e-15  1.0889e-14  1.24713e-14  1.51513e-14  2.00221e-14  2.93487e-14  4.78906e-14  8.57212e-14  1.65266e-13  3.39862e-13  7.40442e-13  1.694e-12  4.02518e-12  9.82271e-12  2.43835e-11  6.1139e-11  1.54131e-10  3.8957e-10  9.85471e-10  2.4919e-09  6.29154e-09  1.58401e-08  3.97026e-08  9.88604e-08  2.43906e-07  5.94347e-07  1.42523e-06  3.34968e-06  7.68316e-06  1.71248e-05  3.69356e-05  7.67939e-05  0.000153385  0.000293454  0.000536405  0.000934467  0.00154666  0.00241985  0.00354613  0.0048037  0.00598662  0.00694908  0.00767487  0.00822628  0.00866  0.00899656  0.00924456  0.009424  0.00955924  0.00966048  0.00972238  0.00974652  0.0097851  0.0097851  0.0097851  0.0097851  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.026861, at last vertex: 0.855678.
|====================================================================|
|**********                                                **********|
|*           Outer iteration with scattering reduced by 1           *|
|**********                                                **********|
|====================================================================|
Setting scaling of acoustic phonon scattering to 1
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.13e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.37e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p26: GR(E=310,:)...   p14: GR(E=170,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p4: GL(E=50,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.329e-05[A/cm2], hcurrent -2.695e-08[A/cm2], total -1.332e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.308e-05[A/cm2], hcurrent -1.367e-16[A/cm2], total  1.308e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.329e-05[A/cm2], hcurrent -2.061e-08[A/cm2], total -1.331e-05[A/cm2]
Contact 1: ecurrent -1.308e-05[A/cm2], hcurrent  5.129e-19[A/cm2], total -1.308e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.693190e+02, |LDOS|=1.781545e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.26e-02, rel_change=1.09e-02;  |p(x)|=3.72e-02, rel_change=4.78e-01.
     |Je(x)|=6.38e-12, rel_change=8.49e-07; |Jh(x)|=1.53e-14, rel_change=8.07e-09.
No inner convergence because first inner loop.
Coherent particle conservation:           -2.229e-07 [A/cm2,n=0]  -2.667e-08 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.228e-07 [A/cm2,n=0]  -1.201e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 1.04e+00[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p31: GL(E=370,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.327e-05[A/cm2], hcurrent  4.708e-09[A/cm2], total -1.326e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.326e-05[A/cm2], hcurrent -2.494e-17[A/cm2], total  1.326e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.327e-05[A/cm2], hcurrent  4.984e-09[A/cm2], total -1.326e-05[A/cm2]
Contact 1: ecurrent -1.326e-05[A/cm2], hcurrent -1.737e-18[A/cm2], total -1.326e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.726699e+02, |LDOS|=1.813532e+02
Inner convergence failed: eps=1.0e-03
      |n(x)|=3.26e-02, rel_change=8.94e-06;  |p(x)|=3.71e-02, rel_change=1.88e-03.
     |Je(x)|=6.41e-12, rel_change=1.12e-08; |Jh(x)|=1.38e-14, rel_change=5.52e-09.
Coherent particle conservation:           -6.998e-09 [A/cm2,n=0]   4.198e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     7.033e-09 [A/cm2,n=0]  -3.744e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.36e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 6 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p4: GL(E=50,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p15: GL(E=180,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.327e-05[A/cm2], hcurrent  1.111e-07[A/cm2], total -1.315e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.327e-05[A/cm2], hcurrent -1.045e-16[A/cm2], total  1.327e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.327e-05[A/cm2], hcurrent  1.435e-07[A/cm2], total -1.312e-05[A/cm2]
Contact 1: ecurrent -1.326e-05[A/cm2], hcurrent -1.717e-18[A/cm2], total -1.326e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.791229e+02, |LDOS|=1.875078e+02
Inner convergence achieved! eps=1.00e-03
      |n(x)|=3.26e-02, rel_change=5.08e-09;  |p(x)|=3.71e-02, rel_change=2.74e-06;
     |Je(x)|=6.41e-12, rel_change=3.52e-10; |Jh(x)|=3.49e-14, rel_change=8.20e-09;
Coherent particle conservation:            3.725e-12 [A/cm2,n=0]   1.093e-07 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.550e-10 [A/cm2,n=0]  -6.502e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.443e-07
hdensity at contact 0: 1.122e-02
edensity at contact 1: 9.787e-03
hdensity at contact 1: 1.279e-07
nE_max at internal vertex 1: 1.38344e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.026861  -0.026861  -0.026861  -0.026861  -0.0266635  -0.0263139  -0.0258863  -0.0254259  -0.0249553  -0.0244729  -0.0239431  -0.0232763  -0.0222881  -0.0206204  -0.0175955  -0.0119752  -0.00168592  0.0150033  0.0352979  0.0556261  0.0760314  0.0969405  0.118354  0.140115  0.16207  0.184117  0.206202  0.228303  0.250409  0.272517  0.294626  0.316735  0.338844  0.360953  0.383062  0.405172  0.427283  0.449395  0.471511  0.493637  0.515784  0.537973  0.56025  0.582698  0.605462  0.628789  0.653068  0.6789  0.707161  0.737898  0.766791  0.789683  0.807003  0.820072  0.829901  0.837259  0.842744  0.84682  0.849831  0.852029  0.8536  0.854681  0.855359  0.855678  0.855678  0.855678  0.855678  
edens = 9.44268e-07  9.44268e-07  9.44268e-07  9.44268e-07  3.20482e-08  1.15118e-09  4.35021e-11  1.7242e-12  7.78683e-14  1.11405e-14  9.85569e-15  1.10514e-14  1.31154e-14  1.69101e-14  2.43352e-14  3.9675e-14  7.30479e-14  1.4823e-13  3.19939e-13  7.13665e-13  1.62264e-12  3.73664e-12  8.6795e-12  2.02731e-11  4.75097e-11  1.11545e-10  2.62143e-10  6.16323e-10  1.44903e-09  3.40532e-09  7.99468e-09  1.87356e-08  4.37814e-08  1.01866e-07  2.3554e-07  5.39944e-07  1.22357e-06  2.73178e-06  5.98673e-06  1.28279e-05  2.67691e-05  5.41979e-05  0.000106102  0.000200261  0.000363575  0.000633751  0.00105883  0.0016915  0.00257206  0.00368897  0.00492284  0.00607728  0.00701683  0.00772789  0.00826855  0.00869186  0.00901895  0.00926026  0.00943566  0.00956793  0.00966658  0.00972683  0.00975031  0.00978724  0.00978724  0.00978724  0.00978724  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.0229112, at last vertex: 0.855564.
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.399e-05[A/cm2], hcurrent  4.018e-08[A/cm2], total -1.395e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.397e-05[A/cm2], hcurrent  4.740e-18[A/cm2], total  1.397e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.399e-05[A/cm2], hcurrent  4.229e-08[A/cm2], total -1.395e-05[A/cm2]
Contact 1: ecurrent -1.397e-05[A/cm2], hcurrent -3.400e-18[A/cm2], total -1.397e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.685318e+02, |LDOS|=1.766680e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.27e-02, rel_change=3.14e-03;  |p(x)|=3.44e-02, rel_change=8.53e-02.
     |Je(x)|=6.76e-12, rel_change=9.23e-08; |Jh(x)|=1.56e-14, rel_change=6.99e-09.
No inner convergence because first inner loop.
Coherent particle conservation:           -2.014e-08 [A/cm2,n=0]   4.084e-08 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.964e-08 [A/cm2,n=0]  -6.544e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.17e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p26: GR(E=310,:)...   p14: GR(E=170,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p24: GR(E=290,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p24: GL(E=290,:)...   p30: GL(E=360,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p0: GL(E=10,:)...   p6: GL(E=80,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.399e-05[A/cm2], hcurrent  3.238e-08[A/cm2], total -1.395e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.398e-05[A/cm2], hcurrent  1.523e-16[A/cm2], total  1.398e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.399e-05[A/cm2], hcurrent  2.966e-08[A/cm2], total -1.396e-05[A/cm2]
Contact 1: ecurrent -1.399e-05[A/cm2], hcurrent  1.141e-18[A/cm2], total -1.399e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.693068e+02, |LDOS|=1.774110e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.27e-02, rel_change=2.71e-06;  |p(x)|=3.43e-02, rel_change=3.24e-04.
     |Je(x)|=6.76e-12, rel_change=9.01e-10; |Jh(x)|=1.56e-14, rel_change=3.27e-09.
Coherent particle conservation:           -1.080e-09 [A/cm2,n=0]   3.234e-08 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.392e-10 [A/cm2,n=0]  -4.452e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.40e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p30: GR(E=360,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 31 (node470) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p0: GL(E=10,:)...   p6: GL(E=80,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.399e-05[A/cm2], hcurrent  9.402e-09[A/cm2], total -1.398e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.399e-05[A/cm2], hcurrent  8.684e-17[A/cm2], total  1.399e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.399e-05[A/cm2], hcurrent  4.821e-08[A/cm2], total -1.394e-05[A/cm2]
Contact 1: ecurrent -1.398e-05[A/cm2], hcurrent  3.467e-19[A/cm2], total -1.398e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.692980e+02, |LDOS|=1.774026e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.27e-02, rel_change=1.61e-09;  |p(x)|=3.43e-02, rel_change=4.94e-06;
     |Je(x)|=6.76e-12, rel_change=8.15e-11; |Jh(x)|=1.16e-14, rel_change=3.22e-09;
Coherent particle conservation:            2.893e-11 [A/cm2,n=0]   9.429e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.748e-11 [A/cm2,n=0]  -6.392e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.495e-07
hdensity at contact 0: 1.008e-02
edensity at contact 1: 9.780e-03
hdensity at contact 1: 1.280e-07
nE_max at internal vertex 1: 1.39158e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0229112  -0.0229112  -0.0229112  -0.0229112  -0.0229216  -0.0228944  -0.0228482  -0.022788  -0.0226984  -0.0225471  -0.0222714  -0.0217499  -0.0207503  -0.0188327  -0.0151839  -0.00837961  0.0037943  0.022962  0.0458919  0.0684817  0.0904402  0.112141  0.133735  0.155283  0.176811  0.198329  0.219844  0.241356  0.262868  0.284379  0.305891  0.327402  0.348913  0.370425  0.391936  0.413448  0.434961  0.456477  0.477998  0.49953  0.521087  0.542692  0.564393  0.586275  0.608487  0.631282  0.655058  0.680431  0.708297  0.738715  0.767367  0.790081  0.807268  0.820234  0.829985  0.837284  0.842727  0.846773  0.849761  0.851941  0.8535  0.854574  0.855247  0.855564  0.855564  0.855564  0.855564  
edens = 9.49525e-07  9.49525e-07  9.49525e-07  9.49525e-07  3.23155e-08  1.16388e-09  4.40906e-11  1.75132e-12  7.91717e-14  1.13517e-14  1.02075e-14  1.17851e-14  1.46026e-14  1.99753e-14  3.09238e-14  5.46004e-14  1.08378e-13  2.34063e-13  5.28714e-13  1.21322e-12  2.79371e-12  6.43298e-12  1.48025e-11  3.40411e-11  7.82579e-11  1.79886e-10  4.13472e-10  9.50301e-10  2.18357e-09  5.01451e-09  1.15033e-08  2.63404e-08  6.01413e-08  1.36728e-07  3.08939e-07  6.92159e-07  1.53333e-06  3.34767e-06  7.17725e-06  1.50531e-05  3.07669e-05  6.10586e-05  0.000117273  0.000217396  0.000388146  0.000666409  0.00109868  0.00173567  0.00261596  0.00372759  0.0049526  0.00609776  0.00703028  0.00773675  0.00827385  0.00869377  0.00901795  0.00925732  0.00943153  0.00956289  0.0096607  0.00972035  0.00974358  0.00978048  0.00978048  0.00978048  0.00978048  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.0227784, at last vertex: 0.855568.
Outer loop converged! |phi_new - phi_old|=8.620e-05 < 1.000e-04
First outer iteration - no convergence.
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -1.399e-05[A/cm2]
Right contact current, calculated from div. of coherent c.: 1.399e-05[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: 9.429e-09[A/cm2]
Right contact current, calculated from div. of coherent c.: 8.685e-17[A/cm2]

potential=-2.277839e-02   -2.277839e-02   -2.277839e-02   -2.277839e-02   -2.281428e-02   -2.281759e-02   -2.279859e-02   -2.276100e-02   -2.268841e-02   -2.254812e-02   -2.227670e-02   -2.175050e-02   -2.073069e-02   -1.876257e-02   -1.500486e-02   -7.999580e-03   4.471300e-03   2.396693e-02   4.716016e-02   6.990505e-02   9.192602e-02   1.136319e-01   1.352009e-01   1.567104e-01   1.781940e-01   1.996663e-01   2.211337e-01   2.425989e-01   2.640632e-01   2.855271e-01   3.069908e-01   3.284545e-01   3.499182e-01   3.713819e-01   3.928459e-01   4.143104e-01   4.357760e-01   4.572440e-01   4.787173e-01   5.002020e-01   5.217102e-01   5.432661e-01   5.649156e-01   5.867431e-01   6.088969e-01   6.316272e-01   6.553368e-01   6.806450e-01   7.084548e-01   7.388282e-01   7.674490e-01   7.901424e-01   8.073140e-01   8.202683e-01   8.300094e-01   8.373026e-01   8.427417e-01   8.467840e-01   8.497696e-01   8.519481e-01   8.535059e-01   8.545792e-01   8.552519e-01   8.555684e-01   8.555684e-01   8.555684e-01   8.555684e-01   
potential at first inner vertex: -0.0227784, at last inner vertex: 0.855568
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 2...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.400e-05[A/cm2], hcurrent  5.956e-09[A/cm2], total -1.399e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.400e-05[A/cm2], hcurrent  9.262e-18[A/cm2], total  1.400e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.400e-05[A/cm2], hcurrent  4.951e-08[A/cm2], total -1.395e-05[A/cm2]
Contact 1: ecurrent -1.400e-05[A/cm2], hcurrent -2.923e-18[A/cm2], total -1.400e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.681439e+02, |LDOS|=1.762735e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.27e-02, rel_change=4.47e-04;  |p(x)|=3.43e-02, rel_change=4.78e-03.
     |Je(x)|=6.77e-12, rel_change=1.27e-09; |Jh(x)|=1.81e-14, rel_change=4.64e-09.
No inner convergence because first inner loop.
Coherent particle conservation:            3.995e-10 [A/cm2,n=0]   6.336e-09 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -3.039e-10 [A/cm2,n=0]  -3.877e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.14e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p26: GR(E=310,:)...   p14: GR(E=170,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   p0: GR(E=10,:)...   
Process 0 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p27: GL(E=320,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.400e-05[A/cm2], hcurrent  2.515e-08[A/cm2], total -1.397e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.400e-05[A/cm2], hcurrent -1.686e-17[A/cm2], total  1.400e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.400e-05[A/cm2], hcurrent -2.290e-08[A/cm2], total -1.402e-05[A/cm2]
Contact 1: ecurrent -1.400e-05[A/cm2], hcurrent -4.875e-19[A/cm2], total -1.400e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.684695e+02, |LDOS|=1.765840e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.27e-02, rel_change=3.76e-07;  |p(x)|=3.43e-02, rel_change=3.34e-05.
     |Je(x)|=6.77e-12, rel_change=7.57e-11; |Jh(x)|=1.66e-14, rel_change=4.85e-09.
Coherent particle conservation:            5.670e-10 [A/cm2,n=0]   2.476e-08 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -5.471e-13 [A/cm2,n=0]  -5.478e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p13: GR(E=160,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p0: GL(E=10,:)...   p6: GL(E=80,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -1.400e-05[A/cm2], hcurrent  4.863e-08[A/cm2], total -1.395e-05[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.400e-05[A/cm2], hcurrent -1.867e-16[A/cm2], total  1.400e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -1.400e-05[A/cm2], hcurrent  5.970e-08[A/cm2], total -1.394e-05[A/cm2]
Contact 1: ecurrent -1.400e-05[A/cm2], hcurrent -1.624e-18[A/cm2], total -1.400e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.679355e+02, |LDOS|=1.760747e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.27e-02, rel_change=2.19e-10;  |p(x)|=3.43e-02, rel_change=7.16e-07;
     |Je(x)|=6.77e-12, rel_change=7.25e-11; |Jh(x)|=1.26e-14, rel_change=5.07e-09;
Coherent particle conservation:            2.022e-10 [A/cm2,n=0]   4.859e-08 [A/cm2,n=1]  
Acoustic phonon particle conservation:     9.274e-13 [A/cm2,n=0]  -4.801e-08 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Inner Convergence reached in 3 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.497e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.781e-03
hdensity at contact 1: 1.280e-07
nE_max at internal vertex 1: 1.39186e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0227784  -0.0227784  -0.0227784  -0.0227784  -0.0228143  -0.0228176  -0.0227986  -0.022761  -0.0226884  -0.0225481  -0.0222767  -0.0217505  -0.0207307  -0.0187626  -0.0150049  -0.00799958  0.0044713  0.0239669  0.0471602  0.069905  0.091926  0.113632  0.135201  0.15671  0.178194  0.199666  0.221134  0.242599  0.264063  0.285527  0.306991  0.328454  0.349918  0.371382  0.392846  0.41431  0.435776  0.457244  0.478717  0.500202  0.52171  0.543266  0.564916  0.586743  0.608897  0.631627  0.655337  0.680645  0.708455  0.738828  0.767449  0.790142  0.807314  0.820268  0.830009  0.837303  0.842742  0.846784  0.84977  0.851948  0.853506  0.854579  0.855252  0.855568  0.855568  0.855568  0.855568  
edens = 9.49702e-07  9.49702e-07  9.49702e-07  9.49702e-07  3.23241e-08  1.16426e-09  4.4107e-11  1.75202e-12  7.92048e-14  1.1368e-14  1.02445e-14  1.18651e-14  1.47719e-14  2.03423e-14  3.17571e-14  5.65528e-14  1.13101e-13  2.45618e-13  5.56675e-13  1.27929e-12  2.94624e-12  6.7791e-12  1.5579e-11  3.57708e-11  8.2094e-11  1.88368e-10  4.32186e-10  9.91495e-10  2.27404e-09  5.21262e-09  1.19355e-08  2.72789e-08  6.21666e-08  1.41063e-07  3.18118e-07  7.11333e-07  1.57268e-06  3.42669e-06  7.33169e-06  1.53453e-05  3.12984e-05  6.19826e-05  0.000118796  0.00021976  0.000391568  0.000670987  0.00110428  0.00174186  0.00262211  0.00373301  0.00495687  0.0061009  0.00703262  0.00773861  0.00827534  0.0086949  0.00901877  0.00925795  0.00943207  0.00956334  0.00966108  0.00972068  0.00974388  0.00978078  0.00978078  0.00978078  0.00978078  
Underrelaxing potential (Kerker mixing: phi = 0.7*phi_new+0.3*phi_old)
Value of new el.stat. potential at first vertex: -0.0227772, at last vertex: 0.855568.
Outer loop converged! |phi_new - phi_old|=2.543e-06 < 1.000e-04
Outer Convergence reached in 2 iterations
|--------------------------------------------------------------------|
|                         *** Output... ***                          |
|--------------------------------------------------------------------|
potential=-2.277720e-02   -2.277720e-02   -2.277720e-02   -2.277720e-02   -2.281379e-02   -2.281765e-02   -2.279884e-02   -2.276127e-02   -2.268876e-02   -2.254871e-02   -2.227785e-02   -2.175256e-02   -2.073379e-02   -1.876595e-02   -1.500585e-02   -7.993313e-03   4.488892e-03   2.399503e-02   4.719418e-02   6.994108e-02   9.196226e-02   1.136678e-01   1.352364e-01   1.567455e-01   1.782286e-01   1.997005e-01   2.211675e-01   2.426323e-01   2.640962e-01   2.855596e-01   3.070230e-01   3.284863e-01   3.499495e-01   3.714129e-01   3.928765e-01   4.143406e-01   4.358058e-01   4.572734e-01   4.787463e-01   5.002306e-01   5.217382e-01   5.432934e-01   5.649420e-01   5.867680e-01   6.089197e-01   6.316469e-01   6.553528e-01   6.806570e-01   7.084631e-01   7.388338e-01   7.674528e-01   7.901451e-01   8.073159e-01   8.202697e-01   8.300103e-01   8.373032e-01   8.427421e-01   8.467842e-01   8.497697e-01   8.519482e-01   8.535060e-01   8.545792e-01   8.552519e-01   8.555684e-01   8.555684e-01   8.555684e-01   8.555684e-01   
potential at first inner vertex: -0.0227772, at last inner vertex: 0.855568
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_JEe2 ...   AC SL: /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V.SLac
 Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V_LDOS_VB ... Done.
Saving contact currents (in [A/cm2]) to /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V.ccurrent ...
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.800V.ccurrent ... Done.
Output of self-energies associated to ee=364 (E=1.752) which is closest to target 1.750

|=======================================================================================|
|********************                                               ********************|
|********************                 Drain:  0.900V                ********************|
|********************                                               ********************|
|=======================================================================================|
*** Updating voltages.. ***
|--------------------------------------------------------------------|
|                         updating voltages                          |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|                        updating fermilevels                        |
|--------------------------------------------------------------------|
---------------------------------------------------
Calculating contact 0 density of states from GR
---------------------------------------------------
Calculating retarded contact self-energy w/o potential
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

Calculating GR w/o potential
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.


p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   Aggregating total DOS...
Communicating total DOS...
---------------------------------------------------
Calculating contact 0 fermilevel (doping=-1.000e-02)
---------------------------------------------------
   initial guess: mu=-1.323808e-02, n=9.155e-07, p=2.082e-02 (Ec=1.422482e+00, Ev=0.000000e+00, dop=-1.00e-02)
 Iteration 1: F = 9.155387e-07(n) - 2.082329e-02(p) - -1.000000e-02(dop) = -1.082238e-02
 Iteration 1: mu_new=5.736008e-03, n_new=9.659e-07, p_new=1.198e-02, dop=-1.00e-02
 Iteration 2: F = 9.659230e-07(n) - 1.197885e-02(p) - -1.000000e-02(dop) = -1.977887e-03
 Iteration 2: mu_new=1.110015e-02, n_new=9.804e-07, p_new=1.013e-02, dop=-1.00e-02
 Iteration 3: F = 9.804397e-07(n) - 1.013318e-02(p) - -1.000000e-02(dop) = -1.322020e-04
 Iteration 3: mu_new=1.151310e-02, n_new=9.816e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 4: F = 9.815623e-07(n) - 1.000172e-02(p) - -1.000000e-02(dop) = -7.362912e-07
 Iteration 4: mu_new=1.151542e-02, n_new=9.816e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 5: F = 9.815686e-07(n) - 1.000098e-02(p) - -1.000000e-02(dop) = -2.324188e-11
Fermilevel convergence reached after 5 iterations: mu=0.0115154
new electrostatic potential underrelaxation parameter: 0.3
new electrostatic potential LATE underrelaxation: 0
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 1...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.46e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.556e-04[A/cm2], hcurrent  1.757e+04[A/cm2], total  1.757e+04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  8.022e+05[A/cm2], hcurrent  6.242e-13[A/cm2], total  8.022e+05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.557e-04[A/cm2], hcurrent  1.757e+04[A/cm2], total  1.757e+04[A/cm2]
Contact 1: ecurrent -8.022e+05[A/cm2], hcurrent -6.245e-13[A/cm2], total -8.022e+05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.679503e+02, |LDOS|=1.763924e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.72e-02, rel_change=4.34e-01;  |p(x)|=3.40e-02, rel_change=7.62e-03.
     |Je(x)|=1.14e-01, rel_change=1.00e+00; |Jh(x)|=2.35e-03, rel_change=9.98e-01.
No inner convergence because first inner loop.
Coherent particle conservation:            8.822e+05 [A/cm2,n=0]   1.923e+04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -8.822e+05 [A/cm2,n=0]  -1.923e+04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.17e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 1.14e+00[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.774e-04[A/cm2], hcurrent  3.431e+03[A/cm2], total  3.431e+03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.189e+04[A/cm2], hcurrent  2.317e-16[A/cm2], total  1.189e+04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.774e-04[A/cm2], hcurrent  3.433e+03[A/cm2], total  3.433e+03[A/cm2]
Contact 1: ecurrent -1.189e+04[A/cm2], hcurrent -3.820e-17[A/cm2], total -1.189e+04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.680705e+02, |LDOS|=1.764988e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.75e-02, rel_change=6.36e-03;  |p(x)|=3.40e-02, rel_change=1.38e-03.
     |Je(x)|=1.62e-03, rel_change=6.90e+01; |Jh(x)|=4.47e-04, rel_change=4.22e+00.
Coherent particle conservation:            1.317e+04 [A/cm2,n=0]   3.707e+03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.317e+04 [A/cm2,n=0]  -3.707e+03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.14e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.42e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.782e-04[A/cm2], hcurrent  7.203e+02[A/cm2], total  7.203e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.882e+02[A/cm2], hcurrent  7.930e-17[A/cm2], total  1.882e+02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.782e-04[A/cm2], hcurrent  7.210e+02[A/cm2], total  7.210e+02[A/cm2]
Contact 1: ecurrent -1.882e+02[A/cm2], hcurrent -1.324e-19[A/cm2], total -1.882e+02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.679304e+02, |LDOS|=1.763633e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.76e-02, rel_change=9.91e-05;  |p(x)|=3.39e-02, rel_change=2.66e-04.
     |Je(x)|=2.58e-05, rel_change=5.39e+01; |Jh(x)|=9.55e-05, rel_change=3.54e+00.
Coherent particle conservation:            2.079e+02 [A/cm2,n=0]   7.736e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -2.079e+02 [A/cm2,n=0]  -7.736e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
|====================================================================|
|                        Inner iteration 4...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.782e-04[A/cm2], hcurrent  1.542e+02[A/cm2], total  1.542e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  2.989e+00[A/cm2], hcurrent  8.708e-17[A/cm2], total  2.989e+00[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.782e-04[A/cm2], hcurrent  1.544e+02[A/cm2], total  1.544e+02[A/cm2]
Contact 1: ecurrent -2.989e+00[A/cm2], hcurrent -1.298e-19[A/cm2], total -2.989e+00[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.704213e+02, |LDOS|=1.787363e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.76e-02, rel_change=1.55e-06;  |p(x)|=3.39e-02, rel_change=5.29e-05.
     |Je(x)|=4.12e-07, rel_change=6.11e+00; |Jh(x)|=2.06e-05, rel_change=3.09e+00.
Coherent particle conservation:            3.300e+00 [A/cm2,n=0]   1.654e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -3.300e+00 [A/cm2,n=0]  -1.654e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_LDOS ... Done.
|====================================================================|
|                        Inner iteration 5...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.17e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.42e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p31: GR(E=370,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p12: GL(E=140,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.782e-04[A/cm2], hcurrent  3.390e+01[A/cm2], total  3.390e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  4.863e-02[A/cm2], hcurrent  8.708e-17[A/cm2], total  4.863e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.782e-04[A/cm2], hcurrent  3.396e+01[A/cm2], total  3.396e+01[A/cm2]
Contact 1: ecurrent -4.863e-02[A/cm2], hcurrent -1.298e-19[A/cm2], total -4.863e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.686835e+02, |LDOS|=1.770800e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.76e-02, rel_change=2.44e-08;  |p(x)|=3.39e-02, rel_change=1.09e-05.
     |Je(x)|=6.78e-09, rel_change=1.08e-01; |Jh(x)|=4.54e-06, rel_change=1.93e+00.
Coherent particle conservation:            5.292e-02 [A/cm2,n=0]   3.635e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -5.292e-02 [A/cm2,n=0]  -3.635e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_LDOS ... Done.
5 inner iterations reached without convergence.
We continue because it is the first outer iteration.
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.506e-07
hdensity at contact 0: 9.950e-03
edensity at contact 1: 1.632e-02
hdensity at contact 1: 1.046e-07
nE_max at internal vertex 1: 1.39252e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0227772  -0.0227772  -0.0227772  -0.0227772  -0.0228138  -0.0228177  -0.0227988  -0.0227613  -0.0226888  -0.0225487  -0.0222778  -0.0217526  -0.0207338  -0.018766  -0.0150058  -0.00799331  0.00448889  0.023995  0.0471942  0.0699411  0.0919623  0.113668  0.135236  0.156745  0.178229  0.199701  0.221167  0.242632  0.264096  0.28556  0.307023  0.328486  0.34995  0.371413  0.392876  0.414341  0.435806  0.457273  0.478746  0.500231  0.521738  0.543293  0.564942  0.586768  0.60892  0.631647  0.655353  0.680657  0.708463  0.738834  0.767453  0.790145  0.807316  0.82027  0.83001  0.837303  0.842742  0.846784  0.84977  0.851948  0.853506  0.854579  0.855252  0.855568  0.855568  0.855568  0.855568  
edens = 9.50568e-07  9.50568e-07  9.50568e-07  9.50568e-07  3.23589e-08  1.16589e-09  4.43641e-11  1.96593e-12  3.1328e-13  2.77271e-13  3.24718e-13  4.06198e-13  5.50348e-13  8.24101e-13  1.3811e-12  2.58779e-12  5.33525e-12  1.17694e-11  2.68675e-11  6.19342e-11  1.42812e-10  3.28722e-10  7.55344e-10  1.73337e-09  3.97358e-09  9.09894e-09  2.08035e-08  4.7453e-08  1.07848e-07  2.43784e-07  5.46798e-07  1.21346e-06  2.65546e-06  5.70849e-06  1.2006e-05  2.45996e-05  4.88924e-05  9.38666e-05  0.000173378  0.000306968  0.000519313  0.00083743  0.00128548  0.00187886  0.00262128  0.00350957  0.00454705  0.00575696  0.00717401  0.00878287  0.0104239  0.0118662  0.013003  0.013867  0.0145312  0.0150425  0.0154273  0.0157116  0.0159215  0.0160783  0.0161959  0.0162729  0.0163001  0.0163209  0.0163209  0.0163209  0.0163209  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.023109, at last vertex: 0.761755.
Outer loop did not converge: |phi_new - phi_old|=6.824e-03 >= 1.000e-04
First outer iteration - no convergence.
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -6.782e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 5.360e-02[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: 3.635e+01[A/cm2]
Right contact current, calculated from div. of coherent c.: 8.709e-17[A/cm2]

potential=-2.310898e-02   -2.310898e-02   -2.310898e-02   -2.310898e-02   -2.314731e-02   -2.315322e-02   -2.313686e-02   -2.310326e-02   -2.303801e-02   -2.291156e-02   -2.266619e-02   -2.218848e-02   -2.125779e-02   -1.945080e-02   -1.597759e-02   -9.456559e-03   2.238700e-03   2.060381e-02   4.232822e-02   6.335057e-02   8.348846e-02   1.032191e-01   1.227628e-01   1.422206e-01   1.616390e-01   1.810393e-01   2.004314e-01   2.198198e-01   2.392064e-01   2.585923e-01   2.779778e-01   2.973631e-01   3.167479e-01   3.361314e-01   3.555115e-01   3.748835e-01   3.942366e-01   4.135493e-01   4.327828e-01   4.518767e-01   4.707548e-01   4.893501e-01   5.076496e-01   5.257474e-01   5.438878e-01   5.624882e-01   5.821498e-01   6.036731e-01   6.280929e-01   6.555493e-01   6.817580e-01   7.025237e-01   7.181809e-01   7.299476e-01   7.387606e-01   7.453392e-01   7.502361e-01   7.538685e-01   7.565455e-01   7.584950e-01   7.598875e-01   7.608488e-01   7.614596e-01   7.617552e-01   7.617552e-01   7.617552e-01   7.617552e-01   
potential at first inner vertex: -0.023109, at last inner vertex: 0.761755
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 2...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.49e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p21: GL(E=250,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.719e-04[A/cm2], hcurrent -1.139e+03[A/cm2], total -1.139e+03[A/cm2]
Right contact (SLGG-SGGL): ecurrent -6.691e+01[A/cm2], hcurrent -1.541e-16[A/cm2], total -6.691e+01[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.719e-04[A/cm2], hcurrent -1.139e+03[A/cm2], total -1.139e+03[A/cm2]
Contact 1: ecurrent  6.691e+01[A/cm2], hcurrent  6.723e-18[A/cm2], total  6.691e+01[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740269e+02, |LDOS|=1.820207e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.46e-02, rel_change=6.60e-01;  |p(x)|=3.45e-02, rel_change=2.05e-02.
     |Je(x)|=1.07e-05, rel_change=7.41e-01; |Jh(x)|=1.50e-04, rel_change=1.01e+00.
No inner convergence because first inner loop.
Coherent particle conservation:           -7.199e+01 [A/cm2,n=0]  -1.242e+03 [A/cm2,n=1]  
Acoustic phonon particle conservation:     7.199e+01 [A/cm2,n=0]   1.242e+03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.19e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 1.06e+00[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p4: GR(E=50,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -2.374e+02[A/cm2], total -2.374e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent -1.321e+00[A/cm2], hcurrent  2.869e-16[A/cm2], total -1.321e+00[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -2.376e+02[A/cm2], total -2.376e+02[A/cm2]
Contact 1: ecurrent  1.321e+00[A/cm2], hcurrent -2.244e-18[A/cm2], total  1.321e+00[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735951e+02, |LDOS|=1.815983e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=2.54e-03;  |p(x)|=3.45e-02, rel_change=6.13e-04.
     |Je(x)|=2.04e-07, rel_change=2.65e+00; |Jh(x)|=2.94e-05, rel_change=3.64e+00.
Coherent particle conservation:           -1.430e+00 [A/cm2,n=0]  -2.563e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.430e+00 [A/cm2,n=0]   2.563e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.14e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -5.362e+01[A/cm2], total -5.362e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent -2.716e-02[A/cm2], hcurrent  4.557e-16[A/cm2], total -2.716e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -5.367e+01[A/cm2], total -5.367e+01[A/cm2]
Contact 1: ecurrent  2.716e-02[A/cm2], hcurrent  9.793e-18[A/cm2], total  2.716e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735164e+02, |LDOS|=1.815234e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=9.68e-07;  |p(x)|=3.45e-02, rel_change=4.13e-05.
     |Je(x)|=4.19e-09, rel_change=5.33e-02; |Jh(x)|=6.81e-06, rel_change=2.14e+00.
Coherent particle conservation:           -3.002e-02 [A/cm2,n=0]  -5.747e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     3.002e-02 [A/cm2,n=0]   5.747e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
|====================================================================|
|                        Inner iteration 4...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -1.230e+01[A/cm2], total -1.230e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  8.925e-05[A/cm2], hcurrent  2.639e-16[A/cm2], total  8.925e-05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -1.232e+01[A/cm2], total -1.232e+01[A/cm2]
Contact 1: ecurrent -8.925e-05[A/cm2], hcurrent -1.151e-17[A/cm2], total -8.925e-05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735406e+02, |LDOS|=1.815466e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=1.10e-09;  |p(x)|=3.45e-02, rel_change=5.26e-06.
     |Je(x)|=2.88e-10, rel_change=1.14e-03; |Jh(x)|=1.57e-06, rel_change=9.86e-01.
Coherent particle conservation:           -6.283e-04 [A/cm2,n=0]  -1.318e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.283e-04 [A/cm2,n=0]   1.318e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_LDOS ... Done.
|====================================================================|
|                        Inner iteration 5...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.17e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -2.884e+00[A/cm2], total -2.884e+00[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.596e-04[A/cm2], hcurrent -2.966e-16[A/cm2], total  6.596e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -2.888e+00[A/cm2], total -2.889e+00[A/cm2]
Contact 1: ecurrent -6.596e-04[A/cm2], hcurrent -9.041e-18[A/cm2], total -6.596e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735368e+02, |LDOS|=1.815430e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=1.07e-11;  |p(x)|=3.45e-02, rel_change=1.00e-06.
     |Je(x)|=3.24e-10, rel_change=2.39e-05; |Jh(x)|=3.71e-07, rel_change=2.92e-01.
Coherent particle conservation:           -1.320e-05 [A/cm2,n=0]  -3.088e+00 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.320e-05 [A/cm2,n=0]   3.088e+00 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_LDOS ... Done.
|====================================================================|
|                        Inner iteration 6...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.42e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -6.847e-01[A/cm2], total -6.854e-01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.716e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.716e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -6.859e-01[A/cm2], total -6.865e-01[A/cm2]
Contact 1: ecurrent -6.716e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.716e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735361e+02, |LDOS|=1.815423e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=1.56e-13;  |p(x)|=3.45e-02, rel_change=2.18e-07.
     |Je(x)|=3.25e-10, rel_change=5.02e-07; |Jh(x)|=8.84e-08, rel_change=7.37e-02.
Coherent particle conservation:           -2.793e-07 [A/cm2,n=0]  -7.331e-01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.781e-07 [A/cm2,n=0]   7.331e-01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_LDOS ... Done.
|====================================================================|
|                        Inner iteration 7...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.57e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -1.634e-01[A/cm2], total -1.640e-01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -1.637e-01[A/cm2], total -1.643e-01[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735371e+02, |LDOS|=1.815433e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=3.23e-15;  |p(x)|=3.45e-02, rel_change=5.04e-08.
     |Je(x)|=3.25e-10, rel_change=1.06e-08; |Jh(x)|=2.11e-08, rel_change=1.79e-02.
Coherent particle conservation:           -6.154e-09 [A/cm2,n=0]  -1.750e-01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     5.881e-09 [A/cm2,n=0]   1.750e-01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_LDOS ... Done.
|====================================================================|
|                        Inner iteration 8...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.16e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -3.851e-02[A/cm2], total -3.918e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -3.858e-02[A/cm2], total -3.925e-02[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735366e+02, |LDOS|=1.815428e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=1.18e-16;  |p(x)|=3.45e-02, rel_change=1.18e-08.
     |Je(x)|=3.25e-10, rel_change=2.24e-10; |Jh(x)|=4.93e-09, rel_change=4.31e-03.
Coherent particle conservation:           -3.660e-10 [A/cm2,n=0]  -4.131e-02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.213e-10 [A/cm2,n=0]   4.131e-02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_LDOS ... Done.
|====================================================================|
|                        Inner iteration 9...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.56e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -8.497e-03[A/cm2], total -9.169e-03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -8.517e-03[A/cm2], total -9.189e-03[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735368e+02, |LDOS|=1.815430e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=5.02e-19;  |p(x)|=3.45e-02, rel_change=2.78e-09.
     |Je(x)|=3.25e-10, rel_change=8.29e-12; |Jh(x)|=1.06e-09, rel_change=1.04e-03.
Coherent particle conservation:           -2.525e-10 [A/cm2,n=0]  -9.176e-03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -2.958e-12 [A/cm2,n=0]   9.176e-03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_LDOS ... Done.
|====================================================================|
|                       Inner iteration 10...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.16e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent -1.363e-03[A/cm2], total -2.035e-03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent -1.368e-03[A/cm2], total -2.040e-03[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735367e+02, |LDOS|=1.815429e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=2.50e-20;  |p(x)|=3.45e-02, rel_change=6.56e-10.
     |Je(x)|=3.25e-10, rel_change=4.35e-12; |Jh(x)|=2.20e-10, rel_change=2.45e-04.
Coherent particle conservation:           -2.545e-10 [A/cm2,n=0]  -1.526e-03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -3.197e-12 [A/cm2,n=0]   1.526e-03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_LDOS ... Done.
|====================================================================|
|                       Inner iteration 11...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent  2.451e-04[A/cm2], total -4.267e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent  2.439e-04[A/cm2], total -4.279e-04[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735367e+02, |LDOS|=1.815429e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=6.01e-21;  |p(x)|=3.45e-02, rel_change=1.80e-10.
     |Je(x)|=3.25e-10, rel_change=3.41e-12; |Jh(x)|=1.69e-10, rel_change=5.40e-05.
Coherent particle conservation:           -2.499e-10 [A/cm2,n=0]   2.074e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -5.531e-12 [A/cm2,n=0]  -2.074e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_LDOS ... Done.
|====================================================================|
|                       Inner iteration 12...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.39e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p18: GR(E=210,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent  5.321e-04[A/cm2], total -1.397e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent  5.319e-04[A/cm2], total -1.400e-04[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735367e+02, |LDOS|=1.815429e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.47e-02, rel_change=6.01e-21;  |p(x)|=3.45e-02, rel_change=1.02e-10.
     |Je(x)|=3.25e-10, rel_change=3.06e-12; |Jh(x)|=1.63e-10, rel_change=1.06e-05.
Coherent particle conservation:           -2.549e-10 [A/cm2,n=0]   5.246e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -3.250e-12 [A/cm2,n=0]  -5.246e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_LDOS ... Done.
|====================================================================|
|                       Inner iteration 13...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.16e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.42e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent  5.178e-04[A/cm2], total -1.540e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.718e-04[A/cm2], hcurrent -2.287e-16[A/cm2], total  6.718e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent  5.178e-04[A/cm2], total -1.540e-04[A/cm2]
Contact 1: ecurrent -6.718e-04[A/cm2], hcurrent -8.186e-18[A/cm2], total -6.718e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735367e+02, |LDOS|=1.815429e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.47e-02, rel_change=6.01e-21;  |p(x)|=3.45e-02, rel_change=8.32e-11;
     |Je(x)|=3.25e-10, rel_change=3.06e-12; |Jh(x)|=1.41e-10, rel_change=6.20e-06;
Coherent particle conservation:           -2.499e-10 [A/cm2,n=0]   5.174e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -5.503e-12 [A/cm2,n=0]  -5.174e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_LDOS ... Done.
Inner loop converged in 13 iterations!
Inner Convergence reached in 13 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.501e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 1.017e-02
hdensity at contact 1: 1.231e-07
nE_max at internal vertex 1: 1.39185e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.023109  -0.023109  -0.023109  -0.023109  -0.0231473  -0.0231532  -0.0231369  -0.0231033  -0.023038  -0.0229116  -0.0226662  -0.0221885  -0.0212578  -0.0194508  -0.0159776  -0.00945656  0.0022387  0.0206038  0.0423282  0.0633506  0.0834885  0.103219  0.122763  0.142221  0.161639  0.181039  0.200431  0.21982  0.239206  0.258592  0.277978  0.297363  0.316748  0.336131  0.355512  0.374884  0.394237  0.413549  0.432783  0.451877  0.470755  0.48935  0.50765  0.525747  0.543888  0.562488  0.58215  0.603673  0.628093  0.655549  0.681758  0.702524  0.718181  0.729948  0.738761  0.745339  0.750236  0.753869  0.756545  0.758495  0.759887  0.760849  0.76146  0.761755  0.761755  0.761755  0.761755  
edens = 9.50124e-07  9.50124e-07  9.50124e-07  9.50124e-07  3.23359e-08  1.16476e-09  4.43061e-11  1.9593e-12  3.07851e-13  2.69697e-13  3.12909e-13  3.85768e-13  5.10966e-13  7.40123e-13  1.18584e-12  2.1019e-12  4.06763e-12  8.38106e-12  1.78132e-11  3.8139e-11  8.15258e-11  1.73722e-10  3.69229e-10  7.83438e-10  1.66062e-09  3.51759e-09  7.44656e-09  1.57511e-08  3.32748e-08  7.01542e-08  1.47464e-07  3.08612e-07  6.41862e-07  1.32366e-06  2.69897e-06  5.42362e-06  1.0702e-05  2.06548e-05  3.88356e-05  7.08633e-05  0.000125062  0.000212924  0.000349226  0.00055185  0.000841664  0.00124301  0.00178473  0.00249932  0.00341275  0.00451033  0.00568282  0.00675966  0.00763265  0.00829519  0.008796  0.00918149  0.00947576  0.00969348  0.00985304  0.00997308  0.0100616  0.0101145  0.0101335  0.0101678  0.0101678  0.0101678  0.0101678  
Underrelaxing potential (Kerker mixing: phi = 0.7*phi_new+0.3*phi_old)
Value of new el.stat. potential at first vertex: -0.0231101, at last vertex: 0.75727.
Outer loop did not converge: |phi_new - phi_old|=9.097e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -6.718e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 6.718e-04[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: 5.174e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: -2.287e-16[A/cm2]

potential=-2.311013e-02   -2.311013e-02   -2.311013e-02   -2.311013e-02   -2.314830e-02   -2.315442e-02   -2.313848e-02   -2.310533e-02   -2.304065e-02   -2.291536e-02   -2.267279e-02   -2.220196e-02   -2.128713e-02   -1.951455e-02   -1.611185e-02   -9.724278e-03   1.745759e-03   1.977946e-02   4.107415e-02   6.158870e-02   8.116208e-02   1.002895e-01   1.192052e-01   1.380197e-01   1.567859e-01   1.755288e-01   1.942607e-01   2.129872e-01   2.317112e-01   2.504340e-01   2.691563e-01   2.878783e-01   3.066003e-01   3.253221e-01   3.440434e-01   3.627633e-01   3.814794e-01   4.001866e-01   4.188760e-01   4.375338e-01   4.561456e-01   4.747081e-01   4.932519e-01   5.118743e-01   5.307764e-01   5.503005e-01   5.709655e-01   5.935042e-01   6.189043e-01   6.472695e-01   6.742794e-01   6.957137e-01   7.119093e-01   7.241064e-01   7.332640e-01   7.401150e-01   7.452231e-01   7.490177e-01   7.518183e-01   7.538613e-01   7.553229e-01   7.563318e-01   7.569678e-01   7.572699e-01   7.572699e-01   7.572699e-01   7.572699e-01   
potential at first inner vertex: -0.0231101, at last inner vertex: 0.75727
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 3...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.46e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.718e-04[A/cm2], hcurrent  4.090e-04[A/cm2], total -2.627e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.714e-04[A/cm2], hcurrent -1.566e-16[A/cm2], total  6.714e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.718e-04[A/cm2], hcurrent  4.087e-04[A/cm2], total -2.631e-04[A/cm2]
Contact 1: ecurrent -6.714e-04[A/cm2], hcurrent -1.994e-17[A/cm2], total -6.714e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.736740e+02, |LDOS|=1.816768e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.34e-02, rel_change=4.08e-02;  |p(x)|=3.45e-02, rel_change=4.01e-03.
     |Je(x)|=3.25e-10, rel_change=2.93e-08; |Jh(x)|=1.08e-10, rel_change=8.81e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -3.805e-07 [A/cm2,n=0]   4.118e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     3.804e-07 [A/cm2,n=0]  -4.117e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.44e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 1.07e+00[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  3.273e-04[A/cm2], total -3.445e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.717e-04[A/cm2], hcurrent -8.493e-17[A/cm2], total  6.717e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  3.273e-04[A/cm2], total -3.445e-04[A/cm2]
Contact 1: ecurrent -6.717e-04[A/cm2], hcurrent  7.909e-18[A/cm2], total -6.717e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.738818e+02, |LDOS|=1.818754e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.34e-02, rel_change=2.40e-05;  |p(x)|=3.45e-02, rel_change=2.41e-05.
     |Je(x)|=3.25e-10, rel_change=1.80e-08; |Jh(x)|=8.72e-11, rel_change=5.57e-06.
Coherent particle conservation:           -7.579e-09 [A/cm2,n=0]   3.288e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     7.405e-09 [A/cm2,n=0]  -3.288e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.46e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  2.900e-04[A/cm2], total -3.817e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.717e-04[A/cm2], hcurrent  4.417e-16[A/cm2], total  6.717e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  2.901e-04[A/cm2], total -3.817e-04[A/cm2]
Contact 1: ecurrent -6.717e-04[A/cm2], hcurrent  2.787e-18[A/cm2], total -6.717e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735522e+02, |LDOS|=1.815604e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.34e-02, rel_change=1.05e-08;  |p(x)|=3.45e-02, rel_change=2.38e-07;
     |Je(x)|=3.25e-10, rel_change=3.09e-10; |Jh(x)|=7.76e-11, rel_change=2.58e-06;
Coherent particle conservation:            4.048e-10 [A/cm2,n=0]   2.907e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.121e-10 [A/cm2,n=0]  -2.907e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Inner Convergence reached in 3 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.501e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.900e-03
hdensity at contact 1: 1.241e-07
nE_max at internal vertex 1: 1.39185e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0231101  -0.0231101  -0.0231101  -0.0231101  -0.0231483  -0.0231544  -0.0231385  -0.0231053  -0.0230407  -0.0229154  -0.0226728  -0.022202  -0.0212871  -0.0195146  -0.0161118  -0.00972428  0.00174576  0.0197795  0.0410741  0.0615887  0.0811621  0.10029  0.119205  0.13802  0.156786  0.175529  0.194261  0.212987  0.231711  0.250434  0.269156  0.287878  0.3066  0.325322  0.344043  0.362763  0.381479  0.400187  0.418876  0.437534  0.456146  0.474708  0.493252  0.511874  0.530776  0.550301  0.570966  0.593504  0.618904  0.64727  0.674279  0.695714  0.711909  0.724106  0.733264  0.740115  0.745223  0.749018  0.751818  0.753861  0.755323  0.756332  0.756968  0.75727  0.75727  0.75727  0.75727  
edens = 9.50122e-07  9.50122e-07  9.50122e-07  9.50122e-07  3.23358e-08  1.16476e-09  4.43058e-11  1.9591e-12  3.07491e-13  2.68973e-13  3.11402e-13  3.82513e-13  5.03635e-13  7.2291e-13  1.14376e-12  1.99538e-12  3.7909e-12  7.65452e-12  1.59234e-11  3.33339e-11  6.96061e-11  1.44784e-10  3.0022e-10  6.21242e-10  1.28396e-09  2.65174e-09  5.47391e-09  1.12937e-08  2.32831e-08  4.79419e-08  9.85314e-08  2.01938e-07  4.122e-07  8.36646e-07  1.68512e-06  3.35964e-06  6.61105e-06  1.27985e-05  2.42924e-05  4.50509e-05  8.13674e-05  0.000142728  0.000242663  0.000399482  0.00063686  0.000984315  0.00147719  0.00215392  0.00304407  0.00413378  0.00531253  0.00640437  0.00729322  0.0079689  0.00848128  0.00887795  0.00918216  0.00940749  0.0095726  0.00969698  0.00978882  0.00984406  0.00986461  0.00990016  0.00990016  0.00990016  0.00990016  
Underrelaxing potential (Kerker mixing: phi = 0.7*phi_new+0.3*phi_old)
Value of new el.stat. potential at first vertex: -0.0231108, at last vertex: 0.755935.
Outer loop did not converge: |phi_new - phi_old|=3.504e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -6.717e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 6.717e-04[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: 2.907e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 4.415e-16[A/cm2]

potential=-2.311081e-02   -2.311081e-02   -2.311081e-02   -2.311081e-02   -2.314900e-02   -2.315529e-02   -2.313956e-02   -2.310659e-02   -2.304208e-02   -2.291702e-02   -2.267515e-02   -2.220642e-02   -2.129700e-02   -1.953705e-02   -1.616172e-02   -9.827901e-03   1.550155e-03   1.944918e-02   4.057148e-02   6.088442e-02   8.023474e-02   9.912408e-02   1.177916e-01   1.363516e-01   1.548594e-01   1.733418e-01   1.918117e-01   2.102755e-01   2.287365e-01   2.471960e-01   2.656549e-01   2.841136e-01   3.025723e-01   3.210312e-01   3.394907e-01   3.579510e-01   3.764129e-01   3.948770e-01   4.133453e-01   4.318219e-01   4.503173e-01   4.688568e-01   4.874956e-01   5.063413e-01   5.255852e-01   5.455401e-01   5.666842e-01   5.897096e-01   6.155716e-01   6.443512e-01   6.717133e-01   6.934333e-01   7.098554e-01   7.222320e-01   7.315314e-01   7.384927e-01   7.436850e-01   7.475433e-01   7.503922e-01   7.524711e-01   7.539589e-01   7.549856e-01   7.556308e-01   7.559353e-01   7.559353e-01   7.559353e-01   7.559353e-01   
potential at first inner vertex: -0.0231108, at last inner vertex: 0.755935
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 4...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p30: GR(E=360,:)...   p18: GR(E=220,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p4: GL(E=50,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  2.306e-04[A/cm2], total -4.411e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.716e-04[A/cm2], hcurrent -5.136e-16[A/cm2], total  6.716e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  2.305e-04[A/cm2], total -4.412e-04[A/cm2]
Contact 1: ecurrent -6.716e-04[A/cm2], hcurrent  6.191e-18[A/cm2], total -6.716e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.707526e+02, |LDOS|=1.788887e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.31e-02, rel_change=1.33e-02;  |p(x)|=3.45e-02, rel_change=1.61e-03.
     |Je(x)|=3.25e-10, rel_change=8.52e-09; |Jh(x)|=6.24e-11, rel_change=4.06e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -1.081e-07 [A/cm2,n=0]   2.315e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.066e-07 [A/cm2,n=0]  -2.314e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.41e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.48e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  1.745e-04[A/cm2], total -4.972e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.717e-04[A/cm2], hcurrent  2.757e-16[A/cm2], total  6.717e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  1.745e-04[A/cm2], total -4.972e-04[A/cm2]
Contact 1: ecurrent -6.717e-04[A/cm2], hcurrent -1.652e-17[A/cm2], total -6.717e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.722260e+02, |LDOS|=1.802956e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.31e-02, rel_change=8.29e-06;  |p(x)|=3.45e-02, rel_change=9.90e-06;
     |Je(x)|=3.25e-10, rel_change=6.73e-09; |Jh(x)|=4.60e-11, rel_change=4.41e-06;
Coherent particle conservation:           -3.219e-09 [A/cm2,n=0]   1.753e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.553e-09 [A/cm2,n=0]  -1.754e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
Inner loop converged in 2 iterations!
Inner Convergence reached in 2 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.501e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.823e-03
hdensity at contact 1: 1.244e-07
nE_max at internal vertex 1: 1.39185e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0231108  -0.0231108  -0.0231108  -0.0231108  -0.023149  -0.0231553  -0.0231396  -0.0231066  -0.0230421  -0.022917  -0.0226752  -0.0222064  -0.021297  -0.019537  -0.0161617  -0.0098279  0.00155015  0.0194492  0.0405715  0.0608844  0.0802347  0.0991241  0.117792  0.136352  0.154859  0.173342  0.191812  0.210276  0.228736  0.247196  0.265655  0.284114  0.302572  0.321031  0.339491  0.357951  0.376413  0.394877  0.413345  0.431822  0.450317  0.468857  0.487496  0.506341  0.525585  0.54554  0.566684  0.58971  0.615572  0.644351  0.671713  0.693433  0.709855  0.722232  0.731531  0.738493  0.743685  0.747543  0.750392  0.752471  0.753959  0.754986  0.755631  0.755935  0.755935  0.755935  0.755935  
edens = 9.50121e-07  9.50121e-07  9.50121e-07  9.50121e-07  3.23358e-08  1.16475e-09  4.43056e-11  1.95904e-12  3.07366e-13  2.68705e-13  3.10826e-13  3.81252e-13  5.00796e-13  7.16275e-13  1.12769e-12  1.95511e-12  3.68754e-12  7.38674e-12  1.52368e-11  3.16147e-11  6.54089e-11  1.34762e-10  2.76723e-10  5.66963e-10  1.16008e-09  2.37191e-09  4.84732e-09  9.90178e-09  2.02143e-08  4.12271e-08  8.39568e-08  1.70589e-07  3.45484e-07  6.96468e-07  1.39515e-06  2.77111e-06  5.44369e-06  1.05458e-05  2.00836e-05  3.74773e-05  6.83117e-05  0.000121282  0.000209265  0.000350394  0.000569013  0.000896361  0.00137037  0.00203231  0.00291394  0.0040023  0.00518621  0.00628664  0.00718359  0.00786533  0.00838268  0.00878419  0.00909278  0.00932142  0.00948883  0.009615  0.00970839  0.00976487  0.00978639  0.00982281  0.00982281  0.00982281  0.00982281  
Value of new el.stat. potential at first vertex: -0.0231113, at last vertex: 0.755363.
Outer loop did not converge: |phi_new - phi_old|=1.760e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -6.717e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 6.717e-04[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: 1.753e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: 2.754e-16[A/cm2]

potential=-2.311127e-02   -2.311127e-02   -2.311127e-02   -2.311127e-02   -2.314952e-02   -2.315594e-02   -2.314034e-02   -2.310748e-02   -2.304298e-02   -2.291789e-02   -2.267614e-02   -2.220811e-02   -2.130092e-02   -1.954688e-02   -1.618542e-02   -9.880043e-03   1.448648e-03   1.927599e-02   4.030820e-02   6.051752e-02   7.975432e-02   9.852305e-02   1.170651e-01   1.354966e-01   1.538739e-01   1.722245e-01   1.905620e-01   2.088932e-01   2.272212e-01   2.455476e-01   2.638734e-01   2.821989e-01   3.005245e-01   3.188506e-01   3.371775e-01   3.555064e-01   3.738390e-01   3.921790e-01   4.105333e-01   4.289143e-01   4.473449e-01   4.658658e-01   4.845465e-01   5.035042e-01   5.229293e-01   5.431221e-01   5.645380e-01   5.878431e-01   6.139692e-01   6.429803e-01   6.705325e-01   6.924020e-01   7.089402e-01   7.214082e-01   7.307793e-01   7.377949e-01   7.430274e-01   7.469153e-01   7.497859e-01   7.518803e-01   7.533784e-01   7.544112e-01   7.550588e-01   7.553630e-01   7.553630e-01   7.553630e-01   7.553630e-01   
potential at first inner vertex: -0.0231113, at last inner vertex: 0.755363
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 5...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.49e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 2 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  1.457e-04[A/cm2], total -5.261e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.717e-04[A/cm2], hcurrent  2.609e-17[A/cm2], total  6.717e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  1.457e-04[A/cm2], total -5.261e-04[A/cm2]
Contact 1: ecurrent -6.717e-04[A/cm2], hcurrent  1.288e-17[A/cm2], total -6.717e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.738630e+02, |LDOS|=1.818616e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.29e-02, rel_change=6.06e-03;  |p(x)|=3.45e-02, rel_change=8.40e-04.
     |Je(x)|=3.25e-10, rel_change=2.60e-09; |Jh(x)|=3.90e-11, rel_change=1.90e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -4.820e-08 [A/cm2,n=0]   1.461e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     4.803e-08 [A/cm2,n=0]  -1.461e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.46e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p7: GR(E=90,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p8: GL(E=100,:)...   p31: GL(E=370,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -6.717e-04[A/cm2], hcurrent  1.295e-04[A/cm2], total -5.423e-04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  6.717e-04[A/cm2], hcurrent -1.617e-16[A/cm2], total  6.717e-04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -6.717e-04[A/cm2], hcurrent  1.295e-04[A/cm2], total -5.423e-04[A/cm2]
Contact 1: ecurrent -6.717e-04[A/cm2], hcurrent  5.155e-18[A/cm2], total -6.717e-04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.746180e+02, |LDOS|=1.825835e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.29e-02, rel_change=3.90e-06;  |p(x)|=3.45e-02, rel_change=4.89e-06;
     |Je(x)|=3.25e-10, rel_change=3.44e-09; |Jh(x)|=3.51e-11, rel_change=1.10e-06;
Coherent particle conservation:           -1.971e-09 [A/cm2,n=0]   1.298e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.242e-09 [A/cm2,n=0]  -1.298e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
Inner loop converged in 2 iterations!
Inner Convergence reached in 2 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.501e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.790e-03
hdensity at contact 1: 1.245e-07
nE_max at internal vertex 1: 1.39185e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0231113  -0.0231113  -0.0231113  -0.0231113  -0.0231495  -0.0231559  -0.0231403  -0.0231075  -0.023043  -0.0229179  -0.0226761  -0.0222081  -0.0213009  -0.0195469  -0.0161854  -0.00988004  0.00144865  0.019276  0.0403082  0.0605175  0.0797543  0.0985231  0.117065  0.135497  0.153874  0.172224  0.190562  0.208893  0.227221  0.245548  0.263873  0.282199  0.300525  0.318851  0.337178  0.355506  0.373839  0.392179  0.410533  0.428914  0.447345  0.465866  0.484546  0.503504  0.522929  0.543122  0.564538  0.587843  0.613969  0.64298  0.670533  0.692402  0.70894  0.721408  0.730779  0.737795  0.743027  0.746915  0.749786  0.75188  0.753378  0.754411  0.755059  0.755363  0.755363  0.755363  0.755363  
edens = 9.50121e-07  9.50121e-07  9.50121e-07  9.50121e-07  3.23357e-08  1.16475e-09  4.43055e-11  1.95901e-12  3.0731e-13  2.68575e-13  3.10538e-13  3.80613e-13  4.99348e-13  7.12892e-13  1.11952e-12  1.93474e-12  3.63558e-12  7.2531e-12  1.48968e-11  3.07703e-11  6.33648e-11  1.29923e-10  2.65471e-10  5.41189e-10  1.10175e-09  2.2412e-09  4.55696e-09  9.26176e-09  1.88137e-08  3.81844e-08  7.73964e-08  1.56563e-07  3.15791e-07  6.3434e-07  1.26701e-06  2.51142e-06  4.92848e-06  9.54949e-06  1.82146e-05  3.40935e-05  6.24309e-05  0.000111526  0.0001939  0.000327539  0.000537062  0.000854537  0.00131925  0.00197405  0.00285194  0.00394049  0.00512798  0.00623356  0.00713504  0.00781999  0.00833988  0.00874384  0.00905462  0.00928482  0.00945321  0.00958009  0.00967406  0.00973098  0.0097528  0.00978951  0.00978951  0.00978951  0.00978951  
Value of new el.stat. potential at first vertex: -0.0231113, at last vertex: 0.755367.
Outer loop converged! |phi_new - phi_old|=9.738e-06 < 1.000e-04
Outer Convergence reached in 5 iterations
|--------------------------------------------------------------------|
|                         *** Output... ***                          |
|--------------------------------------------------------------------|
potential=-2.311135e-02   -2.311135e-02   -2.311135e-02   -2.311135e-02   -2.314963e-02   -2.315607e-02   -2.314050e-02   -2.310765e-02   -2.304312e-02   -2.291796e-02   -2.267609e-02   -2.220791e-02   -2.130058e-02   -1.954663e-02   -1.618599e-02   -9.882970e-03   1.441297e-03   1.926257e-02   4.028809e-02   6.049070e-02   7.972082e-02   9.848285e-02   1.170182e-01   1.354428e-01   1.538131e-01   1.721568e-01   1.904874e-01   2.088116e-01   2.271325e-01   2.454520e-01   2.637707e-01   2.820892e-01   3.004077e-01   3.187266e-01   3.370465e-01   3.553682e-01   3.736937e-01   3.920265e-01   4.103737e-01   4.287479e-01   4.471725e-01   4.656891e-01   4.843689e-01   5.033312e-01   5.227684e-01   5.429814e-01   5.644242e-01   5.877588e-01   6.139125e-01   6.429453e-01   6.705123e-01   6.923909e-01   7.089352e-01   7.214078e-01   7.307823e-01   7.378001e-01   7.430335e-01   7.469219e-01   7.497926e-01   7.518868e-01   7.533846e-01   7.544167e-01   7.550636e-01   7.553673e-01   7.553673e-01   7.553673e-01   7.553673e-01   
potential at first inner vertex: -0.0231113, at last inner vertex: 0.755367
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_JEe ...   AC SL: /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V.SLac
 Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V_LDOS_VB ... Done.
Saving contact currents (in [A/cm2]) to /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V.ccurrent ...
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain0.900V.ccurrent ... Done.
Output of self-energies associated to ee=364 (E=1.752) which is closest to target 1.750

|=======================================================================================|
|********************                                               ********************|
|********************                 Drain:  1.000V                ********************|
|********************                                               ********************|
|=======================================================================================|
*** Updating voltages.. ***
|--------------------------------------------------------------------|
|                         updating voltages                          |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|                        updating fermilevels                        |
|--------------------------------------------------------------------|
---------------------------------------------------
Calculating contact 0 density of states from GR
---------------------------------------------------
Calculating retarded contact self-energy w/o potential
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.before synchronization...S.Z.
Calculating GR w/o potentialbefore synchronization...S.Z.

before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.

before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.
before synchronization...S.Z.


p18: GR(E=210,:)...   p12: GR(E=140,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   Aggregating total DOS...
Communicating total DOS...
---------------------------------------------------
Calculating contact 0 fermilevel (doping=-1.000e-02)
---------------------------------------------------
   initial guess: mu=-1.323808e-02, n=9.155e-07, p=2.045e-02 (Ec=1.422482e+00, Ev=0.000000e+00, dop=-1.00e-02)
 Iteration 1: F = 9.155387e-07(n) - 2.044629e-02(p) - -1.000000e-02(dop) = -1.044537e-02
 Iteration 1: mu_new=5.368170e-03, n_new=9.649e-07, p_new=1.188e-02, dop=-1.00e-02
 Iteration 2: F = 9.649321e-07(n) - 1.188362e-02(p) - -1.000000e-02(dop) = -1.882653e-03
 Iteration 2: mu_new=1.051748e-02, n_new=9.789e-07, p_new=1.012e-02, dop=-1.00e-02
 Iteration 3: F = 9.788569e-07(n) - 1.012189e-02(p) - -1.000000e-02(dop) = -1.209096e-04
 Iteration 3: mu_new=1.089615e-02, n_new=9.799e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 4: F = 9.798854e-07(n) - 1.000160e-02(p) - -1.000000e-02(dop) = -6.161903e-07
 Iteration 4: mu_new=1.089810e-02, n_new=9.799e-07, p_new=1.000e-02, dop=-1.00e-02
 Iteration 5: F = 9.798907e-07(n) - 1.000098e-02(p) - -1.000000e-02(dop) = -1.626220e-11
Fermilevel convergence reached after 5 iterations: mu=0.0108981
new electrostatic potential underrelaxation parameter: 0.3
new electrostatic potential LATE underrelaxation: 0
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 1...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p4: GL(E=50,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.038e-02[A/cm2], hcurrent -3.383e+04[A/cm2], total -3.383e+04[A/cm2]
Right contact (SLGG-SGGL): ecurrent  8.122e+05[A/cm2], hcurrent  6.200e-13[A/cm2], total  8.122e+05[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.039e-02[A/cm2], hcurrent -3.382e+04[A/cm2], total -3.382e+04[A/cm2]
Contact 1: ecurrent -8.122e+05[A/cm2], hcurrent -6.197e-13[A/cm2], total -8.122e+05[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.738774e+02, |LDOS|=1.823295e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.74e-02, rel_change=4.32e-01;  |p(x)|=3.50e-02, rel_change=1.41e-02.
     |Je(x)|=1.16e-01, rel_change=1.00e+00; |Jh(x)|=4.56e-03, rel_change=9.99e-01.
No inner convergence because first inner loop.
Coherent particle conservation:            8.914e+05 [A/cm2,n=0]  -3.698e+04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -8.914e+05 [A/cm2,n=0]   3.698e+04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.47e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.135e-02[A/cm2], hcurrent -6.708e+03[A/cm2], total -6.708e+03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.226e+04[A/cm2], hcurrent -2.357e-16[A/cm2], total  1.226e+04[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.135e-02[A/cm2], hcurrent -6.713e+03[A/cm2], total -6.713e+03[A/cm2]
Contact 1: ecurrent -1.226e+04[A/cm2], hcurrent -3.569e-17[A/cm2], total -1.226e+04[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.735991e+02, |LDOS|=1.820859e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.78e-02, rel_change=6.45e-03;  |p(x)|=3.51e-02, rel_change=2.59e-03.
     |Je(x)|=1.69e-03, rel_change=6.76e+01; |Jh(x)|=8.82e-04, rel_change=4.15e+00.
Coherent particle conservation:            1.356e+04 [A/cm2,n=0]  -7.237e+03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.356e+04 [A/cm2,n=0]   7.237e+03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.138e-02[A/cm2], hcurrent -1.431e+03[A/cm2], total -1.431e+03[A/cm2]
Right contact (SLGG-SGGL): ecurrent  1.979e+02[A/cm2], hcurrent  5.694e-17[A/cm2], total  1.979e+02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.138e-02[A/cm2], hcurrent -1.432e+03[A/cm2], total -1.432e+03[A/cm2]
Contact 1: ecurrent -1.979e+02[A/cm2], hcurrent  7.711e-18[A/cm2], total -1.979e+02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.738161e+02, |LDOS|=1.822969e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.78e-02, rel_change=1.02e-04;  |p(x)|=3.51e-02, rel_change=5.04e-04.
     |Je(x)|=2.75e-05, rel_change=5.32e+01; |Jh(x)|=1.91e-04, rel_change=3.54e+00.
Coherent particle conservation:            2.182e+02 [A/cm2,n=0]  -1.534e+03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -2.182e+02 [A/cm2,n=0]   1.534e+03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
|====================================================================|
|                        Inner iteration 4...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.138e-02[A/cm2], hcurrent -3.112e+02[A/cm2], total -3.113e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.239e+00[A/cm2], hcurrent -5.953e-17[A/cm2], total  3.239e+00[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.138e-02[A/cm2], hcurrent -3.116e+02[A/cm2], total -3.117e+02[A/cm2]
Contact 1: ecurrent -3.239e+00[A/cm2], hcurrent  6.208e-18[A/cm2], total -3.239e+00[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.737672e+02, |LDOS|=1.822511e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.78e-02, rel_change=1.63e-06;  |p(x)|=3.51e-02, rel_change=1.02e-04.
     |Je(x)|=4.55e-07, rel_change=6.45e+00; |Jh(x)|=4.18e-05, rel_change=3.28e+00.
Coherent particle conservation:            3.533e+00 [A/cm2,n=0]  -3.334e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -3.533e+00 [A/cm2,n=0]   3.334e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_LDOS ... Done.
|====================================================================|
|                        Inner iteration 5...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.13e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.63e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p12: GR(E=140,:)...   p0: GR(E=0,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p1: GR(E=20,:)...   p24: GR(E=290,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.138e-02[A/cm2], hcurrent -6.955e+01[A/cm2], total -6.959e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  8.398e-02[A/cm2], hcurrent -5.942e-17[A/cm2], total  8.398e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.138e-02[A/cm2], hcurrent -6.966e+01[A/cm2], total -6.969e+01[A/cm2]
Contact 1: ecurrent -8.398e-02[A/cm2], hcurrent  6.208e-18[A/cm2], total -8.398e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.737416e+02, |LDOS|=1.822268e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=5.78e-02, rel_change=2.63e-08;  |p(x)|=3.51e-02, rel_change=2.13e-05.
     |Je(x)|=1.97e-08, rel_change=1.17e-01; |Jh(x)|=9.40e-06, rel_change=2.47e+00.
Coherent particle conservation:            5.789e-02 [A/cm2,n=0]  -7.445e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -5.789e-02 [A/cm2,n=0]   7.445e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_LDOS ... Done.
5 inner iterations reached without convergence.
We continue because it is the first outer iteration.
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.485e-07
hdensity at contact 0: 1.021e-02
edensity at contact 1: 1.626e-02
hdensity at contact 1: 1.014e-07
nE_max at internal vertex 1: 1.39058e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0231113  -0.0231113  -0.0231113  -0.0231113  -0.0231496  -0.0231561  -0.0231405  -0.0231076  -0.0230431  -0.022918  -0.0226761  -0.0222079  -0.0213006  -0.0195466  -0.016186  -0.00988297  0.0014413  0.0192626  0.0402881  0.0604907  0.0797208  0.0984829  0.117018  0.135443  0.153813  0.172157  0.190487  0.208812  0.227133  0.245452  0.263771  0.282089  0.300408  0.318727  0.337046  0.355368  0.373694  0.392027  0.410374  0.428748  0.447173  0.465689  0.484369  0.503331  0.522768  0.542981  0.564424  0.587759  0.613912  0.642945  0.670512  0.692391  0.708935  0.721408  0.730782  0.7378  0.743034  0.746922  0.749793  0.751887  0.753385  0.754417  0.755064  0.755367  0.755367  0.755367  0.755367  
edens = 9.48509e-07  9.48509e-07  9.48509e-07  9.48509e-07  3.22785e-08  1.1702e-09  5.30552e-11  1.16235e-11  1.09754e-11  1.22982e-11  1.4356e-11  1.76309e-11  2.31779e-11  3.3151e-11  5.21354e-11  9.01862e-11  1.6955e-10  3.38297e-10  6.9473e-10  1.4346e-09  2.95294e-09  6.05072e-09  1.23512e-08  2.51407e-08  5.10581e-08  1.03471e-07  2.09151e-07  4.21295e-07  8.4446e-07  1.68117e-06  3.3163e-06  6.46409e-06  1.24113e-05  2.33946e-05  4.31393e-05  7.75421e-05  0.000135393  0.000228887  0.000373548  0.000587115  0.000887184  0.00128793  0.00179716  0.00241565  0.00314095  0.00397625  0.00494162  0.0060789  0.00743328  0.00898837  0.0105785  0.0119724  0.0130691  0.013903  0.0145435  0.0150352  0.0154048  0.0156785  0.0158806  0.0160311  0.0161442  0.0162183  0.0162438  0.0162639  0.0162639  0.0162639  0.0162639  
First outer iteration. No underrelaxation is performed.
Value of new el.stat. potential at first vertex: -0.0224972, at last vertex: 0.662361.
Outer loop did not converge: |phi_new - phi_old|=6.805e-03 >= 1.000e-04
First outer iteration - no convergence.
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -3.138e-02[A/cm2]
Right contact current, calculated from div. of coherent c.: 8.927e-02[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -7.445e+01[A/cm2]
Right contact current, calculated from div. of coherent c.: -5.941e-17[A/cm2]

potential=-2.249716e-02   -2.249716e-02   -2.249716e-02   -2.249716e-02   -2.253392e-02   -2.253967e-02   -2.252489e-02   -2.249460e-02   -2.243545e-02   -2.232075e-02   -2.209890e-02   -2.166872e-02   -2.083300e-02   -1.921250e-02   -1.609520e-02   -1.021820e-02   4.096389e-04   1.719812e-02   3.685326e-02   5.540834e-02   7.279342e-02   8.958101e-02   1.060613e-01   1.223826e-01   1.386214e-01   1.548174e-01   1.709912e-01   1.871537e-01   2.033103e-01   2.194640e-01   2.356161e-01   2.517668e-01   2.679154e-01   2.840589e-01   3.001909e-01   3.162982e-01   3.323571e-01   3.483294e-01   3.641629e-01   3.798002e-01   3.952012e-01   4.103740e-01   4.254094e-01   4.405060e-01   4.559847e-01   4.722960e-01   4.900338e-01   5.099658e-01   5.330867e-01   5.595002e-01   5.848878e-01   6.050182e-01   6.201884e-01   6.315836e-01   6.401151e-01   6.464821e-01   6.512205e-01   6.547343e-01   6.573232e-01   6.592085e-01   6.605549e-01   6.614846e-01   6.620753e-01   6.623613e-01   6.623613e-01   6.623613e-01   6.623613e-01   
potential at first inner vertex: -0.0224972, at last inner vertex: 0.662361
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step1_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 2...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 16 receivers This time we have 14 receivers This time we have 2 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.47e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.159e-02[A/cm2], hcurrent  2.291e+03[A/cm2], total  2.291e+03[A/cm2]
Right contact (SLGG-SGGL): ecurrent -1.055e+02[A/cm2], hcurrent -1.144e-15[A/cm2], total -1.055e+02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.159e-02[A/cm2], hcurrent  2.290e+03[A/cm2], total  2.290e+03[A/cm2]
Contact 1: ecurrent  1.055e+02[A/cm2], hcurrent  7.811e-17[A/cm2], total  1.055e+02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.734527e+02, |LDOS|=1.815599e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.48e-02, rel_change=6.56e-01;  |p(x)|=3.47e-02, rel_change=1.90e-02.
     |Je(x)|=1.71e-05, rel_change=8.21e-01; |Jh(x)|=3.05e-04, rel_change=1.02e+00.
No inner convergence because first inner loop.
Coherent particle conservation:           -1.137e+02 [A/cm2,n=0]   2.492e+03 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.137e+02 [A/cm2,n=0]  -2.492e+03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p3: GR(E=40,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  4.907e+02[A/cm2], total  4.906e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent -2.103e+00[A/cm2], hcurrent -1.614e-15[A/cm2], total -2.103e+00[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  4.914e+02[A/cm2], total  4.914e+02[A/cm2]
Contact 1: ecurrent  2.103e+00[A/cm2], hcurrent -1.141e-18[A/cm2], total  2.103e+00[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.741183e+02, |LDOS|=1.822246e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=2.08e-03;  |p(x)|=3.47e-02, rel_change=1.48e-03.
     |Je(x)|=3.31e-07, rel_change=4.12e+00; |Jh(x)|=6.51e-05, rel_change=3.48e+00.
Coherent particle conservation:           -2.304e+00 [A/cm2,n=0]   5.280e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.304e+00 [A/cm2,n=0]  -5.280e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.46e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p8: GL(E=100,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  1.130e+02[A/cm2], total  1.130e+02[A/cm2]
Right contact (SLGG-SGGL): ecurrent -1.441e-02[A/cm2], hcurrent -3.408e-15[A/cm2], total -1.441e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  1.132e+02[A/cm2], total  1.131e+02[A/cm2]
Contact 1: ecurrent  1.441e-02[A/cm2], hcurrent -8.338e-17[A/cm2], total  1.441e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.743305e+02, |LDOS|=1.824263e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=8.53e-07;  |p(x)|=3.47e-02, rel_change=7.06e-05.
     |Je(x)|=1.28e-08, rel_change=8.83e-02; |Jh(x)|=1.53e-05, rel_change=2.62e+00.
Coherent particle conservation:           -4.945e-02 [A/cm2,n=0]   1.208e+02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     4.945e-02 [A/cm2,n=0]  -1.208e+02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
|====================================================================|
|                        Inner iteration 4...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.14e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  2.608e+01[A/cm2], total  2.605e+01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.059e-02[A/cm2], hcurrent -1.571e-15[A/cm2], total  3.059e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  2.613e+01[A/cm2], total  2.610e+01[A/cm2]
Contact 1: ecurrent -3.059e-02[A/cm2], hcurrent  3.844e-17[A/cm2], total -3.059e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.742169e+02, |LDOS|=1.823176e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=1.41e-09;  |p(x)|=3.47e-02, rel_change=1.23e-05.
     |Je(x)|=1.52e-08, rel_change=1.93e-03; |Jh(x)|=3.55e-06, rel_change=1.61e+00.
Coherent particle conservation:           -1.061e-03 [A/cm2,n=0]   2.787e+01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.061e-03 [A/cm2,n=0]  -2.787e+01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step4_LDOS ... Done.
|====================================================================|
|                        Inner iteration 5...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.49e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 4 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  6.105e+00[A/cm2], total  6.073e+00[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.156e-02[A/cm2], hcurrent -6.200e-16[A/cm2], total  3.156e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  6.115e+00[A/cm2], total  6.084e+00[A/cm2]
Contact 1: ecurrent -3.156e-02[A/cm2], hcurrent -8.938e-17[A/cm2], total -3.156e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.741293e+02, |LDOS|=1.822339e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=1.28e-11;  |p(x)|=3.47e-02, rel_change=1.44e-06.
     |Je(x)|=1.53e-08, rel_change=4.16e-05; |Jh(x)|=8.34e-07, rel_change=5.93e-01.
Coherent particle conservation:           -2.291e-05 [A/cm2,n=0]   6.518e+00 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.291e-05 [A/cm2,n=0]  -6.518e+00 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step5_LDOS ... Done.
|====================================================================|
|                        Inner iteration 6...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p23: GR(E=270,:)...   p29: GR(E=340,:)...   p5: GR(E=60,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p2: GR(E=30,:)...   p19: GR(E=230,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p30: GR(E=360,:)...   p18: GR(E=220,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  1.446e+00[A/cm2], total  1.414e+00[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.455e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  1.449e+00[A/cm2], total  1.417e+00[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -1.855e-18[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.741031e+02, |LDOS|=1.822089e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=2.66e-13;  |p(x)|=3.47e-02, rel_change=3.92e-07.
     |Je(x)|=1.53e-08, rel_change=9.00e-07; |Jh(x)|=1.98e-07, rel_change=1.61e-01.
Coherent particle conservation:           -4.971e-07 [A/cm2,n=0]   1.544e+00 [A/cm2,n=1]  
Acoustic phonon particle conservation:     4.975e-07 [A/cm2,n=0]  -1.544e+00 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step6_LDOS ... Done.
|====================================================================|
|                        Inner iteration 7...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p6: GR(E=80,:)...   p0: GR(E=10,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p12: GL(E=140,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p28: GL(E=330,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  3.458e-01[A/cm2], total  3.142e-01[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  3.465e-01[A/cm2], total  3.149e-01[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -3.942e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740854e+02, |LDOS|=1.821920e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=5.75e-15;  |p(x)|=3.47e-02, rel_change=9.23e-08.
     |Je(x)|=1.53e-08, rel_change=1.96e-08; |Jh(x)|=4.74e-08, rel_change=3.97e-02.
Coherent particle conservation:           -1.028e-08 [A/cm2,n=0]   3.691e-01 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.086e-08 [A/cm2,n=0]  -3.691e-01 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step7_LDOS ... Done.
|====================================================================|
|                        Inner iteration 8...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.63e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p7: GL(E=90,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  8.261e-02[A/cm2], total  5.103e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  8.279e-02[A/cm2], total  5.121e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -5.108e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740695e+02, |LDOS|=1.821768e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=1.58e-16;  |p(x)|=3.47e-02, rel_change=2.15e-08.
     |Je(x)|=1.53e-08, rel_change=4.27e-10; |Jh(x)|=1.13e-08, rel_change=9.62e-03.
Coherent particle conservation:            3.256e-10 [A/cm2,n=0]   8.825e-02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.385e-10 [A/cm2,n=0]  -8.825e-02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step8_LDOS ... Done.
|====================================================================|
|                        Inner iteration 9...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 6 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p2: GL(E=30,:)...   p19: GL(E=230,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p18: GL(E=220,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  1.905e-02[A/cm2], total -1.253e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  1.910e-02[A/cm2], total -1.248e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -3.181e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740572e+02, |LDOS|=1.821651e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=7.30e-19;  |p(x)|=3.47e-02, rel_change=5.14e-09.
     |Je(x)|=1.53e-08, rel_change=9.14e-12; |Jh(x)|=2.54e-09, rel_change=2.33e-03.
Coherent particle conservation:            5.586e-10 [A/cm2,n=0]   2.043e-02 [A/cm2,n=1]  
Acoustic phonon particle conservation:     3.394e-12 [A/cm2,n=0]  -2.043e-02 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step9_LDOS ... Done.
|====================================================================|
|                       Inner iteration 10...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.15e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.47e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p6: GR(E=70,:)...   p0: GR(E=0,:)...   p18: GR(E=210,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  3.680e-03[A/cm2], total -2.790e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  3.692e-03[A/cm2], total -2.789e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -4.942e-18[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740481e+02, |LDOS|=1.821563e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=9.57e-20;  |p(x)|=3.47e-02, rel_change=1.26e-09.
     |Je(x)|=1.53e-08, rel_change=2.24e-12; |Jh(x)|=5.00e-10, rel_change=5.61e-04.
Coherent particle conservation:            5.917e-10 [A/cm2,n=0]   4.018e-03 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.775e-12 [A/cm2,n=0]  -4.018e-03 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step10_LDOS ... Done.
|====================================================================|
|                       Inner iteration 11...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p6: GL(E=70,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent  5.482e-05[A/cm2], total -3.153e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent  5.809e-05[A/cm2], total -3.152e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -1.507e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740409e+02, |LDOS|=1.821495e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=1.17e-23;  |p(x)|=3.47e-02, rel_change=4.09e-10.
     |Je(x)|=1.53e-08, rel_change=2.04e-12; |Jh(x)|=2.41e-10, rel_change=1.30e-04.
Coherent particle conservation:            5.650e-10 [A/cm2,n=0]   1.364e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.995e-12 [A/cm2,n=0]  -1.364e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step11_LDOS ... Done.
|====================================================================|
|                       Inner iteration 12...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p5: GL(E=60,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p13: GL(E=160,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -7.020e-04[A/cm2], total -3.228e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -7.010e-04[A/cm2], total -3.228e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -1.865e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740351e+02, |LDOS|=1.821440e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.49e-02, rel_change=0.00e+00;  |p(x)|=3.47e-02, rel_change=2.70e-10.
     |Je(x)|=1.53e-08, rel_change=1.96e-12; |Jh(x)|=2.50e-10, rel_change=2.65e-05.
Coherent particle conservation:            5.918e-10 [A/cm2,n=0]  -6.839e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.916e-12 [A/cm2,n=0]   6.839e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step12_LDOS ... Done.
|====================================================================|
|                       Inner iteration 13...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.12e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.62e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p7: GR(E=90,:)...   p13: GR(E=160,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -7.736e-04[A/cm2], total -3.235e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -1.494e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -7.734e-04[A/cm2], total -3.235e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent -1.458e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.740305e+02, |LDOS|=1.821396e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.49e-02, rel_change=0.00e+00;  |p(x)|=3.47e-02, rel_change=2.27e-10;
     |Je(x)|=1.53e-08, rel_change=1.96e-12; |Jh(x)|=2.26e-10, rel_change=8.33e-06;
Coherent particle conservation:            5.650e-10 [A/cm2,n=0]  -7.711e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:    -1.995e-12 [A/cm2,n=0]   7.711e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step13_LDOS ... Done.
Inner loop converged in 13 iterations!
Inner Convergence reached in 13 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.493e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 1.017e-02
hdensity at contact 1: 1.193e-07
nE_max at internal vertex 1: 1.39185e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0224972  -0.0224972  -0.0224972  -0.0224972  -0.0225339  -0.0225397  -0.0225249  -0.0224946  -0.0224354  -0.0223207  -0.0220989  -0.0216687  -0.020833  -0.0192125  -0.0160952  -0.0102182  0.000409639  0.0171981  0.0368533  0.0554083  0.0727934  0.089581  0.106061  0.122383  0.138621  0.154817  0.170991  0.187154  0.20331  0.219464  0.235616  0.251767  0.267915  0.284059  0.300191  0.316298  0.332357  0.348329  0.364163  0.3798  0.395201  0.410374  0.425409  0.440506  0.455985  0.472296  0.490034  0.509966  0.533087  0.5595  0.584888  0.605018  0.620188  0.631584  0.640115  0.646482  0.65122  0.654734  0.657323  0.659208  0.660555  0.661485  0.662075  0.662361  0.662361  0.662361  0.662361  
edens = 9.49329e-07  9.49329e-07  9.49329e-07  9.49329e-07  3.23212e-08  1.17241e-09  5.33091e-11  1.1805e-11  1.11707e-11  1.24954e-11  1.45116e-11  1.76356e-11  2.27617e-11  3.16414e-11  4.78309e-11  7.87196e-11  1.39674e-10  2.61531e-10  5.01917e-10  9.65197e-10  1.84452e-09  3.50026e-09  6.60511e-09  1.24144e-08  2.32691e-08  4.353e-08  8.13034e-08  1.51612e-07  2.8217e-07  5.23787e-07  9.68805e-07  1.78308e-06  3.25983e-06  5.90703e-06  1.05823e-05  1.86886e-05  3.24348e-05  5.51459e-05  9.15744e-05  0.000148134  0.000232974  0.000355877  0.00052812  0.000762632  0.00107494  0.00148519  0.00202067  0.00271568  0.00360082  0.00466698  0.00580913  0.0068594  0.00771029  0.00835423  0.0088394  0.00921254  0.0094978  0.00970896  0.00986342  0.00997947  0.0100651  0.0101162  0.0101341  0.0101682  0.0101682  0.0101682  0.0101682  
Underrelaxing potential (Kerker mixing: phi = 0.7*phi_new+0.3*phi_old)
Value of new el.stat. potential at first vertex: -0.0224974, at last vertex: 0.657962.
Outer loop did not converge: |phi_new - phi_old|=8.948e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -3.158e-02[A/cm2]
Right contact current, calculated from div. of coherent c.: 3.158e-02[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -7.711e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: -1.494e-15[A/cm2]

potential=-2.249739e-02   -2.249739e-02   -2.249739e-02   -2.249739e-02   -2.253550e-02   -2.254244e-02   -2.252852e-02   -2.249893e-02   -2.244071e-02   -2.232777e-02   -2.210956e-02   -2.168695e-02   -2.086698e-02   -1.927851e-02   -1.622436e-02   -1.046517e-02   -3.743523e-05   1.645105e-02   3.570848e-02   5.378292e-02   7.062155e-02   8.681260e-02   1.026598e-01   1.183224e-01   1.338852e-01   1.493939e-01   1.648733e-01   1.803368e-01   1.957918e-01   2.112422e-01   2.266905e-01   2.421376e-01   2.575844e-01   2.730307e-01   2.884758e-01   3.039172e-01   3.193503e-01   3.347672e-01   3.501585e-01   3.655174e-01   3.808508e-01   3.961962e-01   4.116438e-01   4.273603e-01   4.436126e-01   4.607919e-01   4.794404e-01   5.002889e-01   5.243040e-01   5.515570e-01   5.776893e-01   5.984415e-01   6.141122e-01   6.259091e-01   6.347636e-01   6.413866e-01   6.463236e-01   6.499901e-01   6.526958e-01   6.546694e-01   6.560814e-01   6.570561e-01   6.576706e-01   6.579622e-01   6.579622e-01   6.579622e-01   6.579622e-01   
potential at first inner vertex: -0.0224974, at last inner vertex: 0.657962
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step2_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 3...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -5.923e-04[A/cm2], total -3.217e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.156e-02[A/cm2], hcurrent  7.040e-16[A/cm2], total  3.156e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -5.918e-04[A/cm2], total -3.217e-02[A/cm2]
Contact 1: ecurrent -3.156e-02[A/cm2], hcurrent  7.434e-17[A/cm2], total -3.156e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.752061e+02, |LDOS|=1.832676e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.36e-02, rel_change=4.06e-02;  |p(x)|=3.48e-02, rel_change=4.22e-03.
     |Je(x)|=1.53e-08, rel_change=1.38e-06; |Jh(x)|=1.78e-10, rel_change=1.32e-05.
No inner convergence because first inner loop.
Coherent particle conservation:           -1.968e-05 [A/cm2,n=0]  -5.924e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.968e-05 [A/cm2,n=0]   5.924e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.45e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p22: GL(E=260,:)...   p10: GL(E=120,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -5.650e-04[A/cm2], total -3.214e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent  1.739e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -5.650e-04[A/cm2], total -3.214e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent  3.188e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.759393e+02, |LDOS|=1.839687e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.36e-02, rel_change=2.37e-05;  |p(x)|=3.48e-02, rel_change=2.61e-05.
     |Je(x)|=1.53e-08, rel_change=9.51e-07; |Jh(x)|=1.60e-10, rel_change=5.49e-06.
Coherent particle conservation:           -3.460e-07 [A/cm2,n=0]  -5.654e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     3.462e-07 [A/cm2,n=0]   5.655e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.49e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p3: GL(E=40,:)...   p15: GL(E=180,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p7: GL(E=90,:)...   p13: GL(E=160,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -5.028e-04[A/cm2], total -3.208e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -6.083e-16[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -5.027e-04[A/cm2], total -3.208e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent  9.946e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.770288e+02, |LDOS|=1.850109e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.36e-02, rel_change=1.16e-08;  |p(x)|=3.48e-02, rel_change=3.30e-07;
     |Je(x)|=1.53e-08, rel_change=1.56e-08; |Jh(x)|=1.40e-10, rel_change=5.19e-06;
Coherent particle conservation:           -1.008e-08 [A/cm2,n=0]  -5.037e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.001e-08 [A/cm2,n=0]   5.036e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Inner Convergence reached in 3 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.493e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.902e-03
hdensity at contact 1: 1.202e-07
nE_max at internal vertex 1: 1.39184e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0224974  -0.0224974  -0.0224974  -0.0224974  -0.0225355  -0.0225424  -0.0225285  -0.0224989  -0.0224407  -0.0223278  -0.0221096  -0.0216869  -0.020867  -0.0192785  -0.0162244  -0.0104652  -3.74352e-05  0.0164511  0.0357085  0.0537829  0.0706216  0.0868126  0.10266  0.118322  0.133885  0.149394  0.164873  0.180337  0.195792  0.211242  0.22669  0.242138  0.257584  0.273031  0.288476  0.303917  0.31935  0.334767  0.350159  0.365517  0.380851  0.396196  0.411644  0.42736  0.443613  0.460792  0.47944  0.500289  0.524304  0.551557  0.577689  0.598441  0.614112  0.625909  0.634764  0.641387  0.646324  0.64999  0.652696  0.654669  0.656081  0.657056  0.657671  0.657962  0.657962  0.657962  0.657962  
edens = 9.49329e-07  9.49329e-07  9.49329e-07  9.49329e-07  3.23211e-08  1.17241e-09  5.33033e-11  1.17953e-11  1.11532e-11  1.24623e-11  1.44465e-11  1.75024e-11  2.24781e-11  3.10144e-11  4.63947e-11  7.53297e-11  1.31507e-10  2.41754e-10  4.54728e-10  8.5576e-10  1.59828e-09  2.96081e-09  5.44934e-09  9.98309e-09  1.82315e-08  3.32245e-08  6.04545e-08  1.09858e-07  1.9936e-07  3.61169e-07  6.52838e-07  1.17645e-06  2.11121e-06  3.76756e-06  6.67399e-06  1.17111e-05  2.03081e-05  3.47136e-05  5.83407e-05  9.61662e-05  0.000155146  0.0002446  0.00037658  0.000566326  0.000833056  0.00120129  0.00170223  0.00237251  0.00324312  0.00430437  0.00545128  0.00651379  0.00737915  0.00803626  0.00853283  0.00891611  0.00921008  0.00942819  0.00958792  0.00970788  0.00979616  0.00984887  0.00986774  0.00990243  0.00990243  0.00990243  0.00990243  
Underrelaxing potential (Kerker mixing: phi = 0.7*phi_new+0.3*phi_old)
Value of new el.stat. potential at first vertex: -0.0224978, at last vertex: 0.656678.
Outer loop did not converge: |phi_new - phi_old|=3.459e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -3.158e-02[A/cm2]
Right contact current, calculated from div. of coherent c.: 3.158e-02[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -5.037e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: -6.068e-16[A/cm2]

potential=-2.249780e-02   -2.249780e-02   -2.249780e-02   -2.249780e-02   -2.253646e-02   -2.254397e-02   -2.253044e-02   -2.250112e-02   -2.244316e-02   -2.233062e-02   -2.211327e-02   -2.169282e-02   -2.087793e-02   -1.930073e-02   -1.627038e-02   -1.055778e-02   -2.108967e-04   1.615631e-02   3.525441e-02   5.313785e-02   6.976002e-02   8.571465e-02   1.013104e-01   1.167106e-01   1.320035e-01   1.472373e-01   1.624383e-01   1.776213e-01   1.927944e-01   2.079622e-01   2.231273e-01   2.382914e-01   2.534556e-01   2.686209e-01   2.837886e-01   2.989602e-01   3.141380e-01   3.293259e-01   3.445312e-01   3.597688e-01   3.750680e-01   3.904842e-01   4.061142e-01   4.221172e-01   4.387385e-01   4.563396e-01   4.754322e-01   4.967214e-01   5.211543e-01   5.487858e-01   5.752433e-01   5.962604e-01   6.121412e-01   6.241046e-01   6.330917e-01   6.398186e-01   6.448357e-01   6.485636e-01   6.513165e-01   6.533260e-01   6.547649e-01   6.557586e-01   6.563836e-01   6.566784e-01   6.566784e-01   6.566784e-01   6.566784e-01   
potential at first inner vertex: -0.0224978, at last inner vertex: 0.656678
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step3_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 4...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.10e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -4.425e-04[A/cm2], total -3.202e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.157e-02[A/cm2], hcurrent  7.097e-16[A/cm2], total  3.157e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -4.426e-04[A/cm2], total -3.202e-02[A/cm2]
Contact 1: ecurrent -3.157e-02[A/cm2], hcurrent -4.754e-17[A/cm2], total -3.157e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.751405e+02, |LDOS|=1.832080e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.33e-02, rel_change=1.32e-02;  |p(x)|=3.48e-02, rel_change=1.68e-03.
     |Je(x)|=1.53e-08, rel_change=3.76e-07; |Jh(x)|=1.22e-10, rel_change=5.06e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -6.491e-06 [A/cm2,n=0]  -4.420e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.490e-06 [A/cm2,n=0]   4.420e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.11e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.44e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p21: GR(E=250,:)...   p4: GR(E=50,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p21: GL(E=250,:)...   p4: GL(E=50,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -3.443e-04[A/cm2], total -3.192e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent  2.540e-15[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -3.442e-04[A/cm2], total -3.192e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent  6.076e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.755566e+02, |LDOS|=1.836058e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.33e-02, rel_change=8.40e-06;  |p(x)|=3.48e-02, rel_change=1.03e-05.
     |Je(x)|=1.53e-08, rel_change=3.65e-07; |Jh(x)|=9.84e-11, rel_change=6.35e-06.
Coherent particle conservation:           -1.385e-07 [A/cm2,n=0]  -3.455e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     1.384e-07 [A/cm2,n=0]   3.455e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
|====================================================================|
|                        Inner iteration 3...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.10e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.50e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 5 (node124) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -3.196e-04[A/cm2], total -3.190e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -5.378e-18[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -3.196e-04[A/cm2], total -3.190e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent  5.046e-17[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.757799e+02, |LDOS|=1.838193e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.33e-02, rel_change=3.79e-09;  |p(x)|=3.48e-02, rel_change=1.18e-07;
     |Je(x)|=1.53e-08, rel_change=6.17e-09; |Jh(x)|=9.14e-11, rel_change=1.87e-06;
Coherent particle conservation:           -3.514e-09 [A/cm2,n=0]  -3.200e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     3.954e-09 [A/cm2,n=0]   3.200e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step3_LDOS ... Done.
Inner loop converged in 3 iterations!
Inner Convergence reached in 3 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.493e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.828e-03
hdensity at contact 1: 1.205e-07
nE_max at internal vertex 1: 1.39184e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0224978  -0.0224978  -0.0224978  -0.0224978  -0.0225365  -0.022544  -0.0225304  -0.0225011  -0.0224432  -0.0223306  -0.0221133  -0.0216928  -0.0208779  -0.0193007  -0.0162704  -0.0105578  -0.000210897  0.0161563  0.0352544  0.0531378  0.06976  0.0857146  0.10131  0.116711  0.132004  0.147237  0.162438  0.177621  0.192794  0.207962  0.223127  0.238291  0.253456  0.268621  0.283789  0.29896  0.314138  0.329326  0.344531  0.359769  0.375068  0.390484  0.406114  0.422117  0.438739  0.45634  0.475432  0.496721  0.521154  0.548786  0.575243  0.59626  0.612141  0.624105  0.633092  0.639819  0.644836  0.648564  0.651316  0.653326  0.654765  0.655759  0.656384  0.656678  0.656678  0.656678  0.656678  
edens = 9.49329e-07  9.49329e-07  9.49329e-07  9.49329e-07  3.23211e-08  1.1724e-09  5.33017e-11  1.17924e-11  1.11472e-11  1.24503e-11  1.4422e-11  1.74515e-11  2.23692e-11  3.0774e-11  4.58469e-11  7.40468e-11  1.28447e-10  2.34428e-10  4.37469e-10  8.16284e-10  1.51076e-09  2.77203e-09  5.05136e-09  9.15973e-09  1.65542e-08  2.98517e-08  5.37472e-08  9.66508e-08  1.73593e-07  3.1135e-07  5.57424e-07  9.95587e-07  1.7724e-06  3.14153e-06  5.536e-06  9.68219e-06  1.67726e-05  2.87154e-05  4.84732e-05  8.04928e-05  0.000131208  0.000209585  0.000327696  0.000501372  0.000751068  0.00110306  0.00159043  0.00225133  0.00311746  0.0041791  0.00533074  0.00640049  0.00727304  0.0079361  0.00843772  0.0088256  0.00912357  0.00934482  0.00950694  0.00962881  0.00971865  0.00977254  0.00979231  0.00982771  0.00982771  0.00982771  0.00982771  
Value of new el.stat. potential at first vertex: -0.0224981, at last vertex: 0.656129.
Outer loop did not converge: |phi_new - phi_old|=1.731e-04 >= 1.000e-04
---------------------------------------------------
computing coherent electron current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -3.158e-02[A/cm2]
Right contact current, calculated from div. of coherent c.: 3.158e-02[A/cm2]

---------------------------------------------------
computing coherent hole current
---------------------------------------------------
Left  contact current, calculated from div. of coherent c.: -3.200e-04[A/cm2]
Right contact current, calculated from div. of coherent c.: -3.506e-18[A/cm2]

potential=-2.249809e-02   -2.249809e-02   -2.249809e-02   -2.249809e-02   -2.253709e-02   -2.254495e-02   -2.253165e-02   -2.250248e-02   -2.244460e-02   -2.233209e-02   -2.211491e-02   -2.169514e-02   -2.088224e-02   -1.931010e-02   -1.629145e-02   -1.060301e-02   -2.989833e-04   1.600416e-02   3.501938e-02   5.280500e-02   6.931739e-02   8.515269e-02   1.006218e-01   1.158900e-01   1.310470e-01   1.461422e-01   1.612030e-01   1.762446e-01   1.912755e-01   2.063008e-01   2.213231e-01   2.363443e-01   2.513658e-01   2.663891e-01   2.814164e-01   2.964509e-01   3.114983e-01   3.265677e-01   3.416748e-01   3.568453e-01   3.721208e-01   3.875675e-01   4.032888e-01   4.194430e-01   4.362666e-01   4.541049e-01   4.734506e-01   4.949910e-01   5.196586e-01   5.474974e-01   5.741277e-01   5.952819e-01   6.112694e-01   6.233165e-01   6.323692e-01   6.391464e-01   6.442011e-01   6.479571e-01   6.507308e-01   6.527555e-01   6.542053e-01   6.552060e-01   6.558342e-01   6.561295e-01   6.561295e-01   6.561295e-01   6.561295e-01   
potential at first inner vertex: -0.0224981, at last inner vertex: 0.656129
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_step4_LDOS_VB ... Done.
|====================================================================|
|**********                                                **********|
|*                       Outer iteration 5...                       *|
|**********                                                **********|
|====================================================================|
|--------------------------------------------------------------------|
|                    Determining new energy grid                     |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GR
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
---------------------------------------------------
Interpolating GL
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating GG
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GL*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
---------------------------------------------------
Interpolating M*GG*M
---------------------------------------------------
local calculations...  compressing...  Computing total amount of data to be sent...    
Allocating MPI buffer...   
Communicate!
This time we have 32 receivers 
|====================================================================|
|                        Inner iteration 1...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.31e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.96e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p5: GR(E=60,:)...   p28: GR(E=330,:)...   p16: GR(E=190,:)...   p22: GR(E=260,:)...   p10: GR(E=120,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p3: GR(E=40,:)...   p9: GR(E=110,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p12: GL(E=140,:)...   p6: GL(E=70,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p29: GL(E=340,:)...   p23: GL(E=270,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p5: GL(E=60,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -2.872e-04[A/cm2], total -3.186e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.157e-02[A/cm2], hcurrent  1.571e-15[A/cm2], total  3.157e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -2.873e-04[A/cm2], total -3.186e-02[A/cm2]
Contact 1: ecurrent -3.157e-02[A/cm2], hcurrent  2.069e-18[A/cm2], total -3.157e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.805641e+02, |LDOS|=1.884014e+02
Inner convergence failed: eps=1.0e-05
      |n(x)|=3.31e-02, rel_change=5.97e-03;  |p(x)|=3.48e-02, rel_change=8.59e-04.
     |Je(x)|=1.53e-08, rel_change=1.32e-07; |Jh(x)|=7.88e-11, rel_change=3.46e-06.
No inner convergence because first inner loop.
Coherent particle conservation:           -2.982e-06 [A/cm2,n=0]  -2.872e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     2.982e-06 [A/cm2,n=0]   2.872e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step1_LDOS ... Done.
|====================================================================|
|                        Inner iteration 2...                        |
|====================================================================|
|--------------------------------------------------------------------|
|                     calculating self energies                      |
|--------------------------------------------------------------------|
---------------------------------------------------
calculating contact self-energies
---------------------------------------------------
Needed 3.09e+00[s] for the entire self-energy.
---------------------------------------------------
calculating acoustic phonon self-energy
---------------------------------------------------
Needed 8.43e-01[s] for the entire self-energy.
---------------------------------------------------
adding up self energies
---------------------------------------------------
|--------------------------------------------------------------------|
|                           calculating GR                           |
|--------------------------------------------------------------------|
p18: GR(E=210,:)...   p6: GR(E=70,:)...   p0: GR(E=0,:)...   p12: GR(E=140,:)...   p17: GR(E=200,:)...   p29: GR(E=340,:)...   p23: GR(E=270,:)...   p11: GR(E=130,:)...   p28: GR(E=330,:)...   p5: GR(E=60,:)...   p16: GR(E=190,:)...   p10: GR(E=120,:)...   p22: GR(E=260,:)...   p27: GR(E=320,:)...   p4: GR(E=50,:)...   p21: GR(E=250,:)...   p9: GR(E=110,:)...   p3: GR(E=40,:)...   p15: GR(E=180,:)...   p14: GR(E=170,:)...   p26: GR(E=310,:)...   p20: GR(E=240,:)...   p8: GR(E=100,:)...   p31: GR(E=370,:)...   p19: GR(E=230,:)...   p2: GR(E=30,:)...   p25: GR(E=300,:)...   p13: GR(E=160,:)...   p7: GR(E=90,:)...   p18: GR(E=220,:)...   p30: GR(E=360,:)...   p24: GR(E=290,:)...   p1: GR(E=20,:)...   p12: GR(E=150,:)...   p0: GR(E=10,:)...   p6: GR(E=80,:)...   p29: GR(E=350,:)...   p23: GR(E=280,:)...   
Process 20 (node410) was slowest.
|--------------------------------------------------------------------|
|                           calculating GA                           |
|--------------------------------------------------------------------|
|--------------------------------------------------------------------|
|               calculating GL, M*GL*M, GG and M*GG*M                |
|--------------------------------------------------------------------|
p18: GL(E=210,:)...   p6: GL(E=70,:)...   p12: GL(E=140,:)...   p0: GL(E=0,:)...   p17: GL(E=200,:)...   p23: GL(E=270,:)...   p29: GL(E=340,:)...   p5: GL(E=60,:)...   p28: GL(E=330,:)...   p11: GL(E=130,:)...   p16: GL(E=190,:)...   p10: GL(E=120,:)...   p22: GL(E=260,:)...   p27: GL(E=320,:)...   p4: GL(E=50,:)...   p21: GL(E=250,:)...   p9: GL(E=110,:)...   p15: GL(E=180,:)...   p3: GL(E=40,:)...   p14: GL(E=170,:)...   p26: GL(E=310,:)...   p20: GL(E=240,:)...   p31: GL(E=370,:)...   p8: GL(E=100,:)...   p19: GL(E=230,:)...   p2: GL(E=30,:)...   p25: GL(E=300,:)...   p13: GL(E=160,:)...   p7: GL(E=90,:)...   p18: GL(E=220,:)...   p30: GL(E=360,:)...   p24: GL(E=290,:)...   p1: GL(E=20,:)...   p12: GL(E=150,:)...   p6: GL(E=80,:)...   p0: GL(E=10,:)...   p29: GL(E=350,:)...   p23: GL(E=280,:)...   
|--------------------------------------------------------------------|
|                 testing convergence of inner loop                  |
|--------------------------------------------------------------------|
Computing local DOS...
Computing spectral electron density...
Computing spectral     hole density...
Computing spectral electron current (HG-GH)...
Computing spectral     hole current (HG-GH)...
Computing spectral electron current (divergence SL*GG-SG*GL)...
1...
2...
3...
Computing spectral     hole current (divergence SL*GG-SG*GL)...
1...
2...
3...
Left  contact (SLGG-SGGL): ecurrent -3.158e-02[A/cm2], hcurrent -2.139e-04[A/cm2], total -3.179e-02[A/cm2]
Right contact (SLGG-SGGL): ecurrent  3.158e-02[A/cm2], hcurrent -2.507e-16[A/cm2], total  3.158e-02[A/cm2]
Computing contact current (from HG-GH):
Contact 0: ecurrent -3.158e-02[A/cm2], hcurrent -2.138e-04[A/cm2], total -3.179e-02[A/cm2]
Contact 1: ecurrent -3.158e-02[A/cm2], hcurrent  1.884e-16[A/cm2], total -3.158e-02[A/cm2]
Computing electron density...
Computing     hole density...
Integrating over E for electron current (HG-GH)...
Integrating over E for     hole current (HG-GH)...
n+p did not correspond to 2pi*LDOS! |n+p-LDOS|=1.779007e+02, |LDOS|=1.858504e+02
Inner convergence achieved! eps=1.00e-05
      |n(x)|=3.31e-02, rel_change=3.95e-06;  |p(x)|=3.48e-02, rel_change=5.07e-06;
     |Je(x)|=1.53e-08, rel_change=1.85e-07; |Jh(x)|=5.89e-11, rel_change=5.33e-06;
Coherent particle conservation:           -6.783e-08 [A/cm2,n=0]  -2.141e-04 [A/cm2,n=1]  
Acoustic phonon particle conservation:     6.809e-08 [A/cm2,n=0]   2.140e-04 [A/cm2,n=1]  
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEe ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/inner_step2_LDOS ... Done.
Inner loop converged in 2 iterations!
Inner Convergence reached in 2 iterations
Computing local DOS...
Computing spectral electron density...
Computing electron density...
Computing spectral     hole density...
Computing     hole density...
|--------------------------------------------------------------------|
|                      Solving Poisson equation                      |
|--------------------------------------------------------------------|
edensity at contact 0: 9.493e-07
hdensity at contact 0: 1.004e-02
edensity at contact 1: 9.796e-03
hdensity at contact 1: 1.206e-07
nE_max at internal vertex 1: 1.39184e-05
*** PoissonFEM1D*** 
 elstat_pot = -0.0224981  -0.0224981  -0.0224981  -0.0224981  -0.0225371  -0.022545  -0.0225317  -0.0225025  -0.0224446  -0.0223321  -0.0221149  -0.0216951  -0.0208822  -0.0193101  -0.0162914  -0.010603  -0.000298983  0.0160042  0.0350194  0.052805  0.0693174  0.0851527  0.100622  0.11589  0.131047  0.146142  0.161203  0.176245  0.191276  0.206301  0.221323  0.236344  0.251366  0.266389  0.281416  0.296451  0.311498  0.326568  0.341675  0.356845  0.372121  0.387567  0.403289  0.419443  0.436267  0.454105  0.473451  0.494991  0.519659  0.547497  0.574128  0.595282  0.611269  0.623316  0.632369  0.639146  0.644201  0.647957  0.650731  0.652756  0.654205  0.655206  0.655834  0.656129  0.656129  0.656129  0.656129  
edens = 9.49328e-07  9.49328e-07  9.49328e-07  9.49328e-07  3.23211e-08  1.1724e-09  5.33013e-11  1.17913e-11  1.11447e-11  1.24447e-11  1.44101e-11  1.74263e-11  2.23146e-11  3.06529e-11  4.55709e-11  7.34023e-11  1.26917e-10  2.30786e-10  4.28948e-10  7.96943e-10  1.46822e-09  2.68103e-09  4.8611e-09  8.76937e-09  1.57656e-08  2.82788e-08  5.06443e-08  9.05889e-08  1.61855e-07  2.88819e-07  5.14558e-07  9.14812e-07  1.62183e-06  2.86437e-06  5.03338e-06  8.78673e-06  1.52105e-05  2.6057e-05  4.40775e-05  7.34607e-05  0.000120371  0.000193569  0.000305085  0.000470994  0.000712346  0.00105632  0.00153706  0.00219361  0.00305813  0.00412086  0.0052758  0.00634986  0.00722635  0.00789248  0.00839666  0.00878685  0.00908678  0.0093095  0.00947267  0.00959536  0.00968588  0.00974028  0.00976044  0.00979618  0.00979618  0.00979618  0.00979618  
Value of new el.stat. potential at first vertex: -0.0224981, at last vertex: 0.656129.
Outer loop converged! |phi_new - phi_old|=8.776e-06 < 1.000e-04
Outer Convergence reached in 5 iterations
|--------------------------------------------------------------------|
|                         *** Output... ***                          |
|--------------------------------------------------------------------|
potential=-2.249813e-02   -2.249813e-02   -2.249813e-02   -2.249813e-02   -2.253718e-02   -2.254510e-02   -2.253183e-02   -2.250268e-02   -2.244478e-02   -2.233220e-02   -2.211490e-02   -2.169497e-02   -2.088190e-02   -1.930972e-02   -1.629157e-02   -1.060485e-02   -3.043289e-04   1.599371e-02   3.500309e-02   5.278268e-02   6.928899e-02   8.511810e-02   1.005809e-01   1.158426e-01   1.309931e-01   1.460816e-01   1.611357e-01   1.761705e-01   1.911947e-01   2.062131e-01   2.212285e-01   2.362428e-01   2.512574e-01   2.662738e-01   2.812940e-01   2.963215e-01   3.113617e-01   3.264241e-01   3.415246e-01   3.566891e-01   3.719603e-01   3.874055e-01   4.031298e-01   4.192929e-01   4.361319e-01   4.539913e-01   4.733615e-01   4.949266e-01   5.196159e-01   5.474716e-01   5.741135e-01   5.952751e-01   6.112673e-01   6.233177e-01   6.323725e-01   6.391509e-01   6.442059e-01   6.479616e-01   6.507347e-01   6.527586e-01   6.542073e-01   6.552069e-01   6.558341e-01   6.561287e-01   6.561287e-01   6.561287e-01   6.561287e-01   
potential at first inner vertex: -0.0224981, at last inner vertex: 0.656129
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_phi_n_p_J_Ec_Ev ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_JEe ...   AC SL: /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V.SLac
 Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_JEe2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_JEh ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_JEh2 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_Jecont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_Jhcont ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_nE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_pE ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_LDOS ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_LDOS_k0 ... Done.
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V_LDOS_VB ... Done.
Saving contact currents (in [A/cm2]) to /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V.ccurrent ...
Writing /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/pn/pn_Drain1.000V.ccurrent ... Done.
Output of self-energies associated to ee=364 (E=1.752) which is closest to target 1.750
The simulation finished in 1503.65 seconds.
All of this was written into /galileo/home/userexternal/xzhou000/test_negf/negf-reference-master/results/logs/negf_20160114_071226.out.
Thank you for using NEGF. Please report bugs and comments to steiger@iis.ee.ethz.ch.
====================================================================================
